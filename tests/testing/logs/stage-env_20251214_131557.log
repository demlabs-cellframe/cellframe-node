2025-12-14T06:15:57.974623Z [info     ] file_logging_enabled           log_file=/home/olzh/demlabs/second/cellframe-node/tests/stage-env/../testing/logs/stage-env_20251214_131557.log
2025-12-14T06:15:58.124676Z [info     ] artifacts_manager_initialized  artifacts_dir=/home/olzh/demlabs/second/cellframe-node/tests/testing/artifacts collect_crash_dumps=True collect_health_logs=True collect_node_logs=True
2025-12-14T06:15:58.126357Z [info     ] loading_topology_from_template topology=default
2025-12-14T06:15:58.126782Z [info     ] loaded_config                  path=/home/olzh/demlabs/second/cellframe-node/tests/stage-env/config/stage-env.cfg
2025-12-14T06:15:58.132156Z [info     ] cert_generator_initialized     certs_dir=/home/olzh/demlabs/second/cellframe-node/tests/stage-env/cache/certs docker_mode=True
2025-12-14T06:15:58.151832Z [info     ] docker_connected               version=28.5.1
2025-12-14T06:15:58.298914Z [info     ] genesis_initializer_created    network=stagenet
2025-12-14T06:15:58.309358Z [info     ] artifacts_manager_initialized  artifacts_dir=/home/olzh/demlabs/second/cellframe-node/tests/testing/artifacts collect_crash_dumps=True collect_health_logs=True collect_node_logs=True
2025-12-14T06:15:58.326810Z [info     ] filesystem_mode_initialized    rsync_available=True snapshots_dir=/home/olzh/demlabs/second/cellframe-node/tests/testing/snapshots
2025-12-14T06:15:58.326962Z [info     ] snapshot_manager_initialized   base_path=/home/olzh/demlabs/second/cellframe-node/tests/stage-env config={'mode': 'filesystem', 'squashfs_compression': 'none', 'auto_create_on_startup': True, 'snapshot_name': 'clean_state', 'genesis_stage': 'full', 'phase1_snapshot_name': 'phase1_zerochain_genesis', 'auto_cleanup': True, 'keep_snapshot_count': 5, 'snapshots_dir': '../testing/snapshots', 'cache_dir': 'cache'} mode=filesystem
2025-12-14T06:15:58.327492Z [info     ] network_manager_initialized    cache_dir=cache network=stagenet snapshot_mode=filesystem timeouts={'startup': 600, 'health_check': 600, 'command': 30} topology=default
2025-12-14T06:15:58.327811Z [info     ] starting_network               rebuild=False topology=default
2025-12-14T06:15:58.327903Z [info     ] stopping_previous_environment 
2025-12-14T06:15:58.327965Z [info     ] stopping_services              remove_images=False volumes=False
2025-12-14T06:15:58.424307Z [info     ] services_stopped              
2025-12-14T06:15:58.424461Z [info     ] previous_environment_stopped  
2025-12-14T06:15:58.424513Z [info     ] cleanup_stale_resources        project=cellframe-stage
2025-12-14T06:15:58.523915Z [info     ] removing_stale_containers      count=6
2025-12-14T06:16:00.126560Z [info     ] removing_stale_networks        count=1
2025-12-14T06:16:00.386431Z [info     ] cleanup_completed             
2025-12-14T06:16:00.386915Z [info     ] no_phase1_snapshot_cleaning_data_for_fresh_start name=phase1_zerochain_genesis
2025-12-14T06:16:00.387053Z [info     ] cleaning_node_data_after_stop 
2025-12-14T06:16:00.387162Z [info     ] removing_node_data_directories path=/home/olzh/demlabs/second/cellframe-node/tests/stage-env/cache/data
2025-12-14T06:16:00.387238Z [info     ] cleaning_cache_data_with_docker path=/home/olzh/demlabs/second/cellframe-node/tests/stage-env/cache/data
2025-12-14T06:16:00.696890Z [info     ] cache_data_cleaned             output='Cleanup complete'
2025-12-14T06:16:00.697038Z [info     ] node_data_removed             
2025-12-14T06:16:00.697285Z [info     ] node_data_cleaned_and_recreated nodes=0
2025-12-14T06:16:00.697363Z [info     ] generating_node_configs       
2025-12-14T06:16:00.697484Z [info     ] node_configs_generated         count=7 seed_nodes=3 validators=3
2025-12-14T06:16:00.697549Z [info     ] generating_configs_and_certs  
2025-12-14T06:16:00.697598Z [info     ] generating_configurations      force=False network=stagenet nodes=7
2025-12-14T06:16:00.700295Z [info     ] generating_certificates        count=7 force=False
2025-12-14T06:16:00.700443Z [info     ] generating_all_certificates    method=docker network=stagenet nodes=7 validators=3
• Generating 7 node certificates using Docker...
2025-12-14T06:16:00.735517Z [info     ] calling_docker_cert_generator  image=cf-cert-generator:latest network_id=0x1234 network_name=stagenet node_count=7 output_dir=/home/olzh/demlabs/second/cellframe-node/tests/stage-env/cache/certs
2025-12-14T06:16:01.149672Z [info     ] cert_generator_docker_output   stdout=
✓ Generated 7 node + 0 validator certificates
2025-12-14T06:16:01.150961Z [info     ] all_certificates_generated     nodes=7 validators=0
2025-12-14T06:16:01.153313Z [info     ] organizing_validator_certificates
2025-12-14T06:16:01.154407Z [info     ] copying_all_private_certs_to_root1_for_centralized_genesis
2025-12-14T06:16:01.154621Z [info     ] all_private_certs_copied_to_root1 additional_certs=2 note='root-1 can now perform centralized genesis with threshold consensus' own_cert=1 total_pvt_certs=3
2025-12-14T06:16:01.155030Z [info     ] distributing_public_certs_to_all_nodes network=stagenet total_nodes=7
2025-12-14T06:16:01.155403Z [info     ] public_certs_distributed_to_node master_certs=3 node_id=1 root_certs=3
2025-12-14T06:16:01.155786Z [info     ] public_certs_distributed_to_node master_certs=3 node_id=2 root_certs=3
2025-12-14T06:16:01.156149Z [info     ] public_certs_distributed_to_node master_certs=3 node_id=3 root_certs=3
2025-12-14T06:16:01.156502Z [info     ] public_certs_distributed_to_node master_certs=3 node_id=4 root_certs=3
2025-12-14T06:16:01.156871Z [info     ] public_certs_distributed_to_node master_certs=3 node_id=5 root_certs=3
2025-12-14T06:16:01.157239Z [info     ] public_certs_distributed_to_node master_certs=3 node_id=6 root_certs=3
2025-12-14T06:16:01.157630Z [info     ] public_certs_distributed_to_node master_certs=3 node_id=7 root_certs=3
2025-12-14T06:16:01.157687Z [info     ] certificates_generated         count=7
2025-12-14T06:16:01.162858Z [info     ] validator_addresses_collected  addresses=[67B9::ACDD::29A9::2BB6,E27D::1A07::2B16::8205,5E2... count=3
2025-12-14T06:16:01.163071Z [info     ] root_node_addresses_collected  addresses=[9D7E::9DF4::CFE9::DF6F,D5BD::A78B::2529::F743,949... count=3
2025-12-14T06:16:01.163202Z [info     ] validator_addresses_collected  addresses=[67B9::ACDD::29A9::2BB6,E27D::1A07::2B16::8205,5E2... count=3
2025-12-14T06:16:01.163265Z [info     ] mainchain_validators_configured master_validators_count=3 min_validators_count=2 note='Using master node addresses in validators_addrs for mainchain'
2025-12-14T06:16:01.163876Z [info     ] loaded_config                  path=/home/olzh/demlabs/second/cellframe-node/tests/stage-env/config/stage-env.cfg
2025-12-14T06:16:01.168650Z [info     ] configurations_generated       network=stagenet nodes=7
2025-12-14T06:16:01.168778Z [info     ] generating_docker_compose     
2025-12-14T06:16:01.169211Z [info     ] generating_compose_file        build_type=debug cache_dir=cache node_count=7 node_source_type=url
2025-12-14T06:16:01.193547Z [info     ] compose_file_generated         path=/home/olzh/demlabs/second/cellframe-node/tests/stage-env/docker-compose.generated.yml services=7
2025-12-14T06:16:01.193723Z [info     ] node_distribution              full=1 master=3 root=3
2025-12-14T06:16:01.193794Z [info     ] === PHASE 1: ROOT Nodes Startup (DAG-PoA Genesis) ===
2025-12-14T06:16:01.204210Z [info     ] network_consensus_monitor_initialized network=stagenet nodes=3
2025-12-14T06:16:01.221407Z [info     ] Loaded scenario: PHASE 1 - Zerochain Genesis from genesis/phase1_zerochain.yml
2025-12-14T06:16:01.236260Z [info     ] executing_phase1_scenario     
2025-12-14T06:16:01.236405Z [info     ] Starting scenario: PHASE 1 - Zerochain Genesis
2025-12-14T06:16:01.236460Z [info     ] Description: Initialize ROOT nodes, create token and emission
2025-12-14T06:16:01.236541Z [info     ] Executing setup phase...      
2025-12-14T06:16:01.236616Z [info     ] Step 1/4: ConfigStep (cellframe-node)
2025-12-14T06:16:01.236792Z [info     ] Config: regenerating 'cellframe-node' for nodes [0, 1, 2] with vars ['seed_mode']
2025-12-14T06:16:01.237708Z [info     ] cert_generator_initialized     certs_dir=/home/olzh/demlabs/second/cellframe-node/tests/stage-env/cache/certs docker_mode=True
2025-12-14T06:16:01.238759Z [warning  ] Target config file /home/olzh/demlabs/second/cellframe-node/tests/stage-env/cache/configs/node0/cellframe-node.cfg does not exist, skipping regeneration for node 0
2025-12-14T06:16:01.239051Z [info     ] Regenerated cellframe-node.cfg for node 1
2025-12-14T06:16:01.239276Z [info     ] Regenerated cellframe-node.cfg for node 2
2025-12-14T06:16:01.239342Z [info     ] Step 2/4: DockerOpStep        
2025-12-14T06:16:01.239416Z [info     ] Docker operation: start on services ['root-1', 'root-2', 'root-3', 'master-1', 'master-2', 'master-3']
2025-12-14T06:16:01.239482Z [info     ] starting_services              services=['root-0', 'root-1', 'root-2', 'master-0', 'master-1', 'master-2']
2025-12-14T06:16:01.908352Z [info     ] services_started              
2025-12-14T06:16:01.909001Z [info     ] waiting_for_container_ips      containers=['cellframe-stage-root-0', 'cellframe-stage-root-1', 'cellframe-stage-root-2', 'cellframe-stage-master-0', 'cellframe-stage-master-1', 'cellframe-stage-master-2']
2025-12-14T06:16:01.909138Z [info     ] waiting_for_container_ips      containers=['cellframe-stage-root-1', 'cellframe-stage-root-0', 'cellframe-stage-master-0', 'cellframe-stage-root-2', 'cellframe-stage-master-2', 'cellframe-stage-master-1'] timeout=30.0
2025-12-14T06:16:01.940700Z [info     ] all_containers_have_ips        count=6 elapsed=0.0
2025-12-14T06:16:01.940842Z [info     ] ✅ All containers have IP addresses count=6
2025-12-14T06:16:01.940914Z [info     ] ✅ Docker operation 'start' completed
2025-12-14T06:16:01.940978Z [info     ] Step 3/4: NetworkWaitStep     
2025-12-14T06:16:01.941048Z [info     ] Waiting for network state: online on nodes ['root-1', 'root-2', 'root-3', 'master-1', 'master-2', 'master-3']
2025-12-14T06:16:01.966811Z [info     ] waiting_for_nodes_online       node_count=6 timeout=60
2025-12-14T06:16:09.191758Z [info     ] all_nodes_online               count=6 elapsed=7.0s
2025-12-14T06:16:09.191910Z [info     ] ✅ Network state 'online' achieved
2025-12-14T06:16:09.191980Z [info     ] Step 4/4: WaitStep            
2025-12-14T06:16:09.192072Z [info     ] Executing WaitStep. Dump: {'wait': '5s', 'datum': None, 'node': None, 'nodes': None, 'network': None, 'chain': None, 'timeout': 60, 'wallet': None, 'token': None, 'balance': None, 'check_master': True, 'expected_count': None}
2025-12-14T06:16:09.192271Z [info     ] Waiting 5s (5s)               
2025-12-14T06:16:14.201427Z [info     ] collecting_global_context_after_setup nodes=3
2025-12-14T06:16:14.201672Z [info     ] global_context_waiting_for_ips containers=['cellframe-stage-root-0', 'cellframe-stage-root-1', 'cellframe-stage-root-2'] count=3
2025-12-14T06:16:14.201743Z [info     ] waiting_for_container_ips      containers=['cellframe-stage-root-2', 'cellframe-stage-root-1', 'cellframe-stage-root-0'] timeout=30.0
2025-12-14T06:16:14.217612Z [info     ] all_containers_have_ips        count=3 elapsed=0.0
2025-12-14T06:16:14.217765Z [info     ] global_context_ips_collected   count=3 node_ip_map={'node1': '172.20.0.10', 'root-0': '172.20.0.10', 'node2': '172.20.0.11', 'root-1': '172.20.0.11', 'node3': '172.20.0.12', 'root-2': '172.20.0.12'}
2025-12-14T06:16:14.217858Z [info     ] global_context_injected_into_scenario node_count=3 node_ip_map={'node1': '172.20.0.10', 'root-0': '172.20.0.10', 'node2': '172.20.0.11', 'root-1': '172.20.0.11', 'node3': '172.20.0.12', 'root-2': '172.20.0.12'} variables=['network_name', 'topology_name', 'node_ips', 'node_ip', 'node_count', 'root_count', 'master_count', 'full_count', 'root_nodes', 'master_nodes', 'full_nodes']
2025-12-14T06:16:14.218840Z [info     ] Loaded CLI commands from cache: 41 commands
2025-12-14T06:16:14.218934Z [info     ] Executing test phase...       
2025-12-14T06:16:14.219009Z [info     ] Step 1/23: StepGroup          
2025-12-14T06:16:14.219071Z [info     ] Step 1/3: CLIStep             
2025-12-14T06:16:14.219134Z [info     ] CLI: node dump                
2025-12-14T06:16:14.228305Z [info     ] exec_cli_command_debug         command_original='node dump -net stagenet' command_split=['node', 'dump', '-net', 'stagenet'] container=cellframe-stage-root-1 full_cmd_list=['docker', 'exec', 'cellframe-stage-root-1', 'sh', '-c', 'cellframe-node-cli node dump -net stagenet'] shell_cmd='cellframe-node-cli node dump -net stagenet'
2025-12-14T06:16:14.286777Z [info     ] cli_save_node_output_debug     command='node dump -net stagenet' output_length=292 output_preview='Record timestamp: Sun, 14 Dec 2025 06:16:11 +0000\nRecord version: 2\nNode version: 5.7-14\nNode addr: D5BD::A78B::2529::F743\nNet: stagenet\nRole: NODE_ROLE_ROOT\nEvents count: 0\nAtoms count: 0\nUplinks count: 0\nDownlinks count: 0\n-----------------------------------------------------------------\n\n' pattern='Node addr:\\s+([A-Fa-f0-9:]+)'
2025-12-14T06:16:14.287081Z [info     ] Step 2/3: CLIStep             
2025-12-14T06:16:14.287160Z [info     ] CLI: node dump                
2025-12-14T06:16:14.295455Z [info     ] exec_cli_command_debug         command_original='node dump -net stagenet' command_split=['node', 'dump', '-net', 'stagenet'] container=cellframe-stage-root-2 full_cmd_list=['docker', 'exec', 'cellframe-stage-root-2', 'sh', '-c', 'cellframe-node-cli node dump -net stagenet'] shell_cmd='cellframe-node-cli node dump -net stagenet'
2025-12-14T06:16:14.362092Z [info     ] cli_save_node_output_debug     command='node dump -net stagenet' output_length=292 output_preview='Record timestamp: Sun, 14 Dec 2025 06:16:11 +0000\nRecord version: 2\nNode version: 5.7-14\nNode addr: 949F::7803::ECA9::4385\nNet: stagenet\nRole: NODE_ROLE_ROOT\nEvents count: 0\nAtoms count: 0\nUplinks count: 0\nDownlinks count: 0\n-----------------------------------------------------------------\n\n' pattern='Node addr:\\s+([A-Fa-f0-9:]+)'
2025-12-14T06:16:14.362293Z [info     ] Step 3/3: CLIStep             
2025-12-14T06:16:14.362363Z [info     ] CLI: node dump                
2025-12-14T06:16:14.365288Z [error    ] container_not_found            container=cellframe-stage-root-3 node=root-3
2025-12-14T06:16:14.366518Z [error    ] root_nodes_genesis_failed      error="CLI command failed: Expected success but got exit code 1\nStep: node dump -net stagenet\nContext: {'stdout': '', 'stderr': 'Container cellframe-stage-root-3 not found', 'returncode': 1}" traceback='Traceback (most recent call last):\n  File "/home/olzh/demlabs/second/cellframe-node/tests/stage-env/src/network/manager.py", line 394, in start\n    ctx = await executor.execute_scenario(\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/olzh/demlabs/second/cellframe-node/tests/stage-env/src/scenarios/executor.py", line 504, in execute_scenario\n    await self._execute_steps(scenario.test.steps, ctx, section_defaults)\n  File "/home/olzh/demlabs/second/cellframe-node/tests/stage-env/src/scenarios/executor.py", line 572, in _execute_steps\n    await self._execute_steps(step.steps, ctx, group_defaults)\n  File "/home/olzh/demlabs/second/cellframe-node/tests/stage-env/src/scenarios/executor.py", line 582, in _execute_steps\n    await self.cli_executor.execute(step, ctx, defaults)\n  File "/home/olzh/demlabs/second/cellframe-node/tests/stage-env/src/scenarios/step/cli.py", line 72, in execute\n    raise ScenarioExecutionError(\nsrc.scenarios.executor.ScenarioExecutionError: CLI command failed: Expected success but got exit code 1\nStep: node dump -net stagenet\nContext: {\'stdout\': \'\', \'stderr\': \'Container cellframe-stage-root-3 not found\', \'returncode\': 1}\n'
2025-12-14T06:16:14.366664Z [info     ] keep_running_enabled_containers_not_stopped phase=Phase1
