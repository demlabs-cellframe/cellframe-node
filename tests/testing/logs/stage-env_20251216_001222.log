2025-12-15T17:12:22.264113Z [info     ] file_logging_enabled           log_file=/home/olzh/demlabs/second/cellframe-node/tests/stage-env/../testing/logs/stage-env_20251216_001222.log
2025-12-15T17:12:22.383409Z [info     ] artifacts_manager_initialized  artifacts_dir=/home/olzh/demlabs/second/cellframe-node/tests/testing/artifacts collect_crash_dumps=True collect_health_logs=True collect_node_logs=True
2025-12-15T17:12:22.384733Z [info     ] loading_topology_from_template topology=default
2025-12-15T17:12:22.385116Z [info     ] loaded_config                  path=/home/olzh/demlabs/second/cellframe-node/tests/stage-env/config/stage-env.cfg
2025-12-15T17:12:22.390328Z [info     ] cert_generator_initialized     certs_dir=/home/olzh/demlabs/second/cellframe-node/tests/stage-env/cache/certs docker_mode=True
2025-12-15T17:12:22.406316Z [info     ] docker_connected               version=28.5.1
2025-12-15T17:12:22.531322Z [info     ] genesis_initializer_created    network=stagenet
2025-12-15T17:12:22.539485Z [info     ] artifacts_manager_initialized  artifacts_dir=/home/olzh/demlabs/second/cellframe-node/tests/testing/artifacts collect_crash_dumps=True collect_health_logs=True collect_node_logs=True
2025-12-15T17:12:22.539986Z [info     ] snapshot_manager_initialized   base_path=/home/olzh/demlabs/second/cellframe-node/tests/stage-env config={'mode': 'disabled', 'squashfs_compression': 'none', 'auto_create_on_startup': True, 'snapshot_name': 'clean_state', 'genesis_stage': 'full', 'phase1_snapshot_name': 'phase1_zerochain_genesis', 'auto_cleanup': True, 'keep_snapshot_count': 5, 'snapshots_dir': '../testing/snapshots', 'cache_dir': 'cache'} mode=disabled
2025-12-15T17:12:22.549599Z [info     ] network_manager_initialized    cache_dir=cache network=stagenet snapshot_mode=disabled timeouts={'startup': 600, 'health_check': 600, 'command': 30} topology=default
2025-12-15T17:12:22.549900Z [info     ] starting_network               rebuild=False topology=default
2025-12-15T17:12:22.549977Z [info     ] stopping_previous_environment 
2025-12-15T17:12:22.550023Z [info     ] stopping_services              remove_images=False volumes=False
2025-12-15T17:12:22.611230Z [info     ] services_stopped              
2025-12-15T17:12:22.611359Z [info     ] previous_environment_stopped  
2025-12-15T17:12:22.611405Z [info     ] cleanup_stale_resources        project=cellframe-stage
2025-12-15T17:12:22.655220Z [info     ] cleanup_completed             
2025-12-15T17:12:22.655357Z [info     ] snapshot_system_disabled_or_auto_create_disabled_cleaning_data
2025-12-15T17:12:22.655485Z [info     ] generating_node_configs       
2025-12-15T17:12:22.655583Z [info     ] node_configs_generated         count=8 seed_nodes=3 validators=3
2025-12-15T17:12:22.655645Z [info     ] generating_configs_and_certs  
2025-12-15T17:12:22.655689Z [info     ] generating_configurations      force=False network=stagenet nodes=8
2025-12-15T17:12:22.670212Z [info     ] preparing_certificate_directories count=8 note='Certificates will be created inside containers after startup'
2025-12-15T17:12:22.671790Z [info     ] certificate_directories_prepared note='Run create_certificates_in_containers() after container startup'
2025-12-15T17:12:22.675883Z [info     ] validator_addresses_collected  addresses=[] count=0
2025-12-15T17:12:22.676044Z [info     ] root_node_addresses_collected  addresses=[] count=0
2025-12-15T17:12:22.676131Z [info     ] validator_addresses_collected  addresses=[] count=0
2025-12-15T17:12:22.676185Z [info     ] mainchain_validators_configured master_validators_count=3 min_validators_count=2 note='Using master node addresses in validators_addrs for mainchain'
2025-12-15T17:12:22.676575Z [info     ] loaded_config                  path=/home/olzh/demlabs/second/cellframe-node/tests/stage-env/config/stage-env.cfg
2025-12-15T17:12:22.680734Z [info     ] configurations_generated       network=stagenet nodes=8
2025-12-15T17:12:22.680815Z [info     ] generating_docker_compose     
2025-12-15T17:12:22.681153Z [info     ] generating_compose_file        build_type=debug cache_dir=cache node_count=8 node_source_type=url
2025-12-15T17:12:22.704903Z [info     ] compose_file_generated         path=/home/olzh/demlabs/second/cellframe-node/tests/stage-env/docker-compose.generated.yml services=8
2025-12-15T17:12:22.705018Z [info     ] node_distribution              full=2 master=3 root=3
2025-12-15T17:12:22.705081Z [info     ] === PHASE 1: ROOT Nodes Startup (DAG-PoA Genesis) ===
2025-12-15T17:12:22.712433Z [info     ] network_consensus_monitor_initialized network=stagenet nodes=3
2025-12-15T17:12:22.726325Z [info     ] Loaded scenario: PHASE 1 - Zerochain Genesis from genesis/phase1_zerochain.yml
2025-12-15T17:12:22.740735Z [info     ] executing_phase1_scenario     
2025-12-15T17:12:22.740873Z [info     ] Starting scenario: PHASE 1 - Zerochain Genesis
2025-12-15T17:12:22.740921Z [info     ] Description: Initialize ROOT nodes, create token and emission
2025-12-15T17:12:22.740990Z [info     ] Executing setup phase...      
2025-12-15T17:12:22.741056Z [info     ] Step 1/7: ConfigStep (cellframe-node)
2025-12-15T17:12:22.741216Z [info     ] Config: regenerating 'cellframe-node' for nodes [1, 2, 3] with vars ['seed_mode']
2025-12-15T17:12:22.742101Z [info     ] cert_generator_initialized     certs_dir=/home/olzh/demlabs/second/cellframe-node/tests/stage-env/cache/certs docker_mode=True
2025-12-15T17:12:22.743213Z [info     ] Regenerated cellframe-node.cfg for node 1
2025-12-15T17:12:22.743428Z [info     ] Regenerated cellframe-node.cfg for node 2
2025-12-15T17:12:22.743593Z [info     ] Regenerated cellframe-node.cfg for node 3
2025-12-15T17:12:22.743661Z [info     ] Step 2/7: DockerOpStep        
2025-12-15T17:12:22.743727Z [info     ] Docker operation: start on services ['root-1', 'root-2', 'root-3', 'master-1', 'master-2', 'master-3']
2025-12-15T17:12:22.743820Z [info     ] starting_services              services=['node-1', 'node-2', 'node-3', 'node-4', 'node-5', 'node-6']
2025-12-15T17:26:41.007443Z [error    ] command_failed                 cmd='docker compose -f /home/olzh/demlabs/second/cellframe-node/tests/stage-env/docker-compose.generated.yml -p cellframe-stage up -d node-1 node-2 node-3 node-4 node-5 node-6' exit_code=1 stderr='Dockerfile.cellframe:99\n\n--------------------\n\n  98 |     # Download and install Cellframe Node based on NODE_SOURCE_TYPE\n\n  99 | >>> RUN set -x && \\\n\n 100 | >>>     if [ "$NODE_SOURCE_TYPE" = "local" ]; then \\\n\n 101 | >>>         echo "Using local package: $LOCAL_PACKAGE_NAME" && \\\n\n 102 | >>>         if [ -z "$LOCAL_PACKAGE_NAME" ]; then \\\n\n 103 | >>>             echo "ERROR: LOCAL_PACKAGE_NAME not specified for local source" && \\\n\n 104 | >>>             exit 1; \\\n\n 105 | >>>         fi && \\\n\n 106 | >>>         if [ ! -f "/tmp/packages/$LOCAL_PACKAGE_NAME" ]; then \\\n\n 107 | >>>             echo "ERROR: Local package not found: /tmp/packages/$LOCAL_PACKAGE_NAME" && \\\n\n 108 | >>>             echo "Available files in /tmp/packages:" && \\\n\n 109 | >>>             ls -la /tmp/packages/ 2>/dev/null || echo "Directory /tmp/packages does not exist" && \\\n\n 110 | >>>             exit 1; \\\n\n 111 | >>>         fi && \\\n\n 112 | >>>         echo "Found local package: /tmp/packages/$LOCAL_PACKAGE_NAME" && \\\n\n 113 | >>>         cp "/tmp/packages/$LOCAL_PACKAGE_NAME" /tmp/cellframe-node.deb; \\\n\n 114 | >>>     elif [ "$NODE_SOURCE_TYPE" = "url" ]; then \\\n\n 115 | >>>         echo "Downloading from URL..." && \\\n\n 116 | >>>         # Universal architecture detection (works on all Unix systems)\n\n 117 | >>>         UNAME_ARCH=$(uname -m) && \\\n\n 118 | >>>         echo "Hardware architecture: $UNAME_ARCH" && \\\n\n 119 | >>>         \\\n\n 120 | >>>         # Map hardware architecture to Debian package architecture\n\n 121 | >>>         case "$UNAME_ARCH" in \\\n\n 122 | >>>             x86_64|amd64) \\\n\n 123 | >>>                 ARCH="amd64" ;; \\\n\n 124 | >>>             aarch64|arm64) \\\n\n 125 | >>>                 ARCH="arm64" ;; \\\n\n 126 | >>>             armv7l|armhf) \\\n\n 127 | >>>                 ARCH="armhf" ;; \\\n\n 128 | >>>             i386|i686) \\\n\n 129 | >>>                 ARCH="i386" ;; \\\n\n 130 | >>>             *) \\\n\n 131 | >>>                 echo "WARNING: Unknown architecture $UNAME_ARCH, defaulting to amd64" && \\\n\n 132 | >>>                 ARCH="amd64" ;; \\\n\n 133 | >>>         esac && \\\n\n 134 | >>>         echo "Package architecture: $ARCH" && \\\n\n 135 | >>>         \\\n\n 136 | >>>         # Set package suffix based on build type and architecture\n\n 137 | >>>         # Note: ARM packages are typically only available in release format\n\n 138 | >>>         if [ "$BUILD_TYPE" = "release" ] || [ "$ARCH" = "arm64" ] || [ "$ARCH" = "armhf" ]; then \\\n\n 139 | >>>             PACKAGE_SUFFIX=""; \\\n\n 140 | >>>             if [ "$BUILD_TYPE" = "debug" ] && [ "$ARCH" != "amd64" ]; then \\\n\n 141 | >>>                 echo "INFO: Debug packages not available for $ARCH, using release package"; \\\n\n 142 | >>>             fi; \\\n\n 143 | >>>         else \\\n\n 144 | >>>             PACKAGE_SUFFIX="-dbg"; \\\n\n 145 | >>>         fi && \\\n\n 146 | >>>         \\\n\n 147 | >>>         # Create cache key for this configuration\n\n 148 | >>>         CACHE_KEY="${CELLFRAME_VERSION}_${BUILD_TYPE}_${ARCH}" && \\\n\n 149 | >>>         CACHE_FILE="/var/cache/cellframe-packages/cellframe-node-${CACHE_KEY}.deb" && \\\n\n 150 | >>>         CACHE_INFO="/var/cache/cellframe-packages/cellframe-node-${CACHE_KEY}.info" && \\\n\n 151 | >>>         CACHE_TIMESTAMP="/var/cache/cellframe-packages/cellframe-node-${CACHE_KEY}.timestamp" && \\\n\n 152 | >>>         echo "Cache key: $CACHE_KEY" && \\\n\n 153 | >>>         \\\n\n 154 | >>>         # For \'latest\', always check if newer version available (cache max 1 day)\n\n 155 | >>>         USE_CACHE=false && \\\n\n 156 | >>>         if [ -f "$CACHE_FILE" ] && [ -f "$CACHE_INFO" ]; then \\\n\n 157 | >>>             if [ "$CELLFRAME_VERSION" = "latest" ] && [ -f "$CACHE_TIMESTAMP" ]; then \\\n\n 158 | >>>                 CACHE_AGE=$(($(date +%s) - $(cat "$CACHE_TIMESTAMP"))) && \\\n\n 159 | >>>                 if [ $CACHE_AGE -lt 86400 ]; then \\\n\n 160 | >>>                     echo "Cache is recent (${CACHE_AGE}s old), using cached package" && \\\n\n 161 | >>>                     USE_CACHE=true; \\\n\n 162 | >>>                 else \\\n\n 163 | >>>                     echo "Cache is old (${CACHE_AGE}s), will check for updates" && \\\n\n 164 | >>>                     USE_CACHE=false; \\\n\n 165 | >>>                 fi; \\\n\n 166 | >>>             else \\\n\n 167 | >>>                 echo "Using cached package for specific version" && \\\n\n 168 | >>>                 USE_CACHE=true; \\\n\n 169 | >>>             fi; \\\n\n 170 | >>>         fi && \\\n\n 171 | >>>         \\\n\n 172 | >>>         if [ "$USE_CACHE" = "true" ]; then \\\n\n 173 | >>>             echo "Found cached package: $CACHE_FILE" && \\\n\n 174 | >>>             CACHED_INFO=$(cat "$CACHE_INFO") && \\\n\n 175 | >>>             echo "Cached info: $CACHED_INFO" && \\\n\n 176 | >>>             cp "$CACHE_FILE" /tmp/cellframe-node.deb; \\\n\n 177 | >>>         else \\\n\n 178 | >>>             echo "Downloading fresh package..." && \\\n\n 179 | >>>             \\\n\n 180 | >>>             # Use PACKAGE_URL if provided, otherwise determine from version\n\n 181 | >>>             if [ -n "$PACKAGE_URL" ]; then \\\n\n 182 | >>>                 DOWNLOAD_URL="$PACKAGE_URL"; \\\n\n 183 | >>>                 echo "Using provided URL: $DOWNLOAD_URL"; \\\n\n 184 | >>>             elif [ "$CELLFRAME_VERSION" = "latest" ]; then \\\n\n 185 | >>>                 # For latest version, get the most recent available for current architecture\n\n 186 | >>>                 echo "Fetching latest version for architecture: $ARCH" && \\\n\n 187 | >>>                 LATEST_VERSION=$(wget -qO- http://pub.cellframe.net/linux/cellframe-node/master/ | \\\n\n 188 | >>>                                 grep -oP "cellframe-node-\\K[0-9]+\\.[0-9]+-[0-9]+(?=${PACKAGE_SUFFIX}-${ARCH}\\.deb)" | \\\n\n 189 | >>>                                 sort -V | tail -1); \\\n\n 190 | >>>                 if [ -z "$LATEST_VERSION" ]; then \\\n\n 191 | >>>                     echo "ERROR: No Cellframe Node packages found for architecture: $ARCH" && \\\n\n 192 | >>>                     echo "FAIL FAST: Check package availability or use specific version" && \\\n\n 193 | >>>                     exit 1; \\\n\n 194 | >>>                 fi && \\\n\n 195 | >>>                 DOWNLOAD_URL="http://pub.cellframe.net/linux/cellframe-node/master/cellframe-node-${LATEST_VERSION}${PACKAGE_SUFFIX}-${ARCH}.deb" && \\\n\n 196 | >>>                 ACTUAL_VERSION="$LATEST_VERSION"; \\\n\n 197 | >>>             else \\\n\n 198 | >>>                 # Use specific version for current architecture\n\n 199 | >>>                 DOWNLOAD_URL="http://pub.cellframe.net/linux/cellframe-node/master/cellframe-node-${CELLFRAME_VERSION}${PACKAGE_SUFFIX}-${ARCH}.deb" && \\\n\n 200 | >>>                 ACTUAL_VERSION="$CELLFRAME_VERSION"; \\\n\n 201 | >>>             fi && \\\n\n 202 | >>>             \\\n\n 203 | >>>             echo "Download configuration:" && \\\n\n 204 | >>>             echo "  Hardware: $UNAME_ARCH" && \\\n\n 205 | >>>             echo "  Package arch: $ARCH" && \\\n\n 206 | >>>             echo "  Build type: $BUILD_TYPE (suffix: $PACKAGE_SUFFIX)" && \\\n\n 207 | >>>             echo "  Version: ${ACTUAL_VERSION:-$CELLFRAME_VERSION}" && \\\n\n 208 | >>>             echo "  URL: $DOWNLOAD_URL" && \\\n\n 209 | >>>             \\\n\n 210 | >>>             # Download with Fail Fast principle - no fallbacks\n\n 211 | >>>             echo "Downloading exact package for $ARCH architecture..." && \\\n\n 212 | >>>             wget -O /tmp/cellframe-node.deb "$DOWNLOAD_URL" || { \\\n\n 213 | >>>                 echo "ERROR: Failed to download Cellframe Node package" && \\\n\n 214 | >>>                 echo "  URL: $DOWNLOAD_URL" && \\\n\n 215 | >>>                 echo "  Architecture: $ARCH" && \\\n\n 216 | >>>                 echo "  Version: ${ACTUAL_VERSION:-$CELLFRAME_VERSION}" && \\\n\n 217 | >>>                 echo "  Build type: $BUILD_TYPE" && \\\n\n 218 | >>>                 echo "FAIL FAST: No fallbacks - fix the configuration or package availability" && \\\n\n 219 | >>>                 exit 1; \\\n\n 220 | >>>             } && \\\n\n 221 | >>>             \\\n\n 222 | >>>             # Cache the downloaded package for future builds\n\n 223 | >>>             echo "Caching package for future use..." && \\\n\n 224 | >>>             cp /tmp/cellframe-node.deb "$CACHE_FILE" && \\\n\n 225 | >>>             echo "version=${ACTUAL_VERSION:-$CELLFRAME_VERSION},arch=${ARCH},build_type=${BUILD_TYPE},download_url=${DOWNLOAD_URL}" > "$CACHE_INFO" && \\\n\n 226 | >>>             date +%s > "$CACHE_TIMESTAMP" && \\\n\n 227 | >>>             echo "Cached at: $(date)"; \\\n\n 228 | >>>         fi; \\\n\n 229 | >>>     elif [ "$NODE_SOURCE_TYPE" = "repository" ]; then \\\n\n 230 | >>>         echo "ERROR: Repository source type not yet implemented in Dockerfile" && \\\n\n 231 | >>>         echo "  REPOSITORY_URL: $REPOSITORY_URL" && \\\n\n 232 | >>>         echo "  REPOSITORY_BRANCH: $REPOSITORY_BRANCH" && \\\n\n 233 | >>>         exit 1; \\\n\n 234 | >>>     else \\\n\n 235 | >>>         echo "ERROR: Unknown NODE_SOURCE_TYPE: $NODE_SOURCE_TYPE" && \\\n\n 236 | >>>         echo "Supported types: local, url, repository" && \\\n\n 237 | >>>         exit 1; \\\n\n 238 | >>>     fi && \\\n\n 239 | >>>     \\\n\n 240 | >>>     # Install package with dependency resolution\n\n 241 | >>>     # Note: postinst script may fail in Docker build context (e.g., systemd, network access)\n\n 242 | >>>     # We install package and handle postinst errors gracefully\n\n 243 | >>>     echo "Installing Cellframe Node package..." && \\\n\n 244 | >>>     # Install package (postinst may fail, but files will be extracted)\n\n 245 | >>>     # Use set +e to allow postinst errors without failing the build\n\n 246 | >>>     set +e && \\\n\n 247 | >>>     DEBIAN_FRONTEND=noninteractive dpkg -i --force-depends --force-confold /tmp/cellframe-node.deb 2>&1; \\\n\n 248 | >>>     INSTALL_EXIT=$?; \\\n\n 249 | >>>     set -e && \\\n\n 250 | >>>     # Fix broken package state if postinst failed\n\n 251 | >>>     if [ "$INSTALL_EXIT" -ne 0 ]; then \\\n\n 252 | >>>         echo "Package installation had errors (exit code: $INSTALL_EXIT), fixing state..."; \\\n\n 253 | >>>         # Fix any broken dependencies and package state\n\n 254 | >>>         apt-get update -qq && \\\n\n 255 | >>>         DEBIAN_FRONTEND=noninteractive apt-get install -f -y -qq && \\\n\n 256 | >>>         # Try to configure package again (may still fail, but files are installed)\n\n 257 | >>>         DEBIAN_FRONTEND=noninteractive dpkg --configure -a 2>&1 || true; \\\n\n 258 | >>>     else \\\n\n 259 | >>>         # Normal installation path - fix dependencies\n\n 260 | >>>         apt-get update -qq && \\\n\n 261 | >>>         DEBIAN_FRONTEND=noninteractive apt-get install -f -y -qq; \\\n\n 262 | >>>     fi && \\\n\n 263 | >>>     # Verify package is installed (files exist even if postinst failed)\n\n 264 | >>>     if [ -d "/opt/cellframe-node" ]; then \\\n\n 265 | >>>         echo "Package installed successfully (postinst may have warnings)"; \\\n\n 266 | >>>     else \\\n\n 267 | >>>         echo "ERROR: Package files not found after installation"; \\\n\n 268 | >>>         exit 1; \\\n\n 269 | >>>     fi && \\\n\n 270 | >>>     rm /tmp/cellframe-node.deb\n\n 271 |     \n\n--------------------\n\ntarget node-5: failed to solve: process "/bin/sh -c set -x &&     if [ \\"$NODE_SOURCE_TYPE\\" = \\"local\\" ]; then         echo \\"Using local package: $LOCAL_PACKAGE_NAME\\" &&         if [ -z \\"$LOCAL_PACKAGE_NAME\\" ]; then             echo \\"ERROR: LOCAL_PACKAGE_NAME not specified for local source\\" &&             exit 1;         fi &&         if [ ! -f \\"/tmp/packages/$LOCAL_PACKAGE_NAME\\" ]; then             echo \\"ERROR: Local package not found: /tmp/packages/$LOCAL_PACKAGE_NAME\\" &&             echo \\"Available files in /tmp/packages:\\" &&             ls -la /tmp/packages/ 2>/dev/null || echo \\"Directory /tmp/packages does not exist\\" &&             exit 1;         fi &&         echo \\"Found local package: /tmp/packages/$LOCAL_PACKAGE_NAME\\" &&         cp \\"/tmp/packages/$LOCAL_PACKAGE_NAME\\" /tmp/cellframe-node.deb;     elif [ \\"$NODE_SOURCE_TYPE\\" = \\"url\\" ]; then         echo \\"Downloading from URL...\\" &&         UNAME_ARCH=$(uname -m) &&         echo \\"Hardware architecture: $UNAME_ARCH\\" &&                 case \\"$UNAME_ARCH\\" in             x86_64|amd64)                 ARCH=\\"amd64\\" ;;             aarch64|arm64)                 ARCH=\\"arm64\\" ;;             armv7l|armhf)                 ARCH=\\"armhf\\" ;;             i386|i686)                 ARCH=\\"i386\\" ;;             *)                 echo \\"WARNING: Unknown architecture $UNAME_ARCH, defaulting to amd64\\" &&                 ARCH=\\"amd64\\" ;;         esac &&         echo \\"Package architecture: $ARCH\\" &&                 if [ \\"$BUILD_TYPE\\" = \\"release\\" ] || [ \\"$ARCH\\" = \\"arm64\\" ] || [ \\"$ARCH\\" = \\"armhf\\" ]; then             PACKAGE_SUFFIX=\\"\\";             if [ \\"$BUILD_TYPE\\" = \\"debug\\" ] && [ \\"$ARCH\\" != \\"amd64\\" ]; then                 echo \\"INFO: Debug packages not available for $ARCH, using release package\\";             fi;         else             PACKAGE_SUFFIX=\\"-dbg\\";         fi &&                 CACHE_KEY=\\"${CELLFRAME_VERSION}_${BUILD_TYPE}_${ARCH}\\" &&         CACHE_FILE=\\"/var/cache/cellframe-packages/cellframe-node-${CACHE_KEY}.deb\\" &&         CACHE_INFO=\\"/var/cache/cellframe-packages/cellframe-node-${CACHE_KEY}.info\\" &&         CACHE_TIMESTAMP=\\"/var/cache/cellframe-packages/cellframe-node-${CACHE_KEY}.timestamp\\" &&         echo \\"Cache key: $CACHE_KEY\\" &&                 USE_CACHE=false &&         if [ -f \\"$CACHE_FILE\\" ] && [ -f \\"$CACHE_INFO\\" ]; then             if [ \\"$CELLFRAME_VERSION\\" = \\"latest\\" ] && [ -f \\"$CACHE_TIMESTAMP\\" ]; then                 CACHE_AGE=$(($(date +%s) - $(cat \\"$CACHE_TIMESTAMP\\"))) &&                 if [ $CACHE_AGE -lt 86400 ]; then                     echo \\"Cache is recent (${CACHE_AGE}s old), using cached package\\" &&                     USE_CACHE=true;                 else                     echo \\"Cache is old (${CACHE_AGE}s), will check for updates\\" &&                     USE_CACHE=false;                 fi;             else                 echo \\"Using cached package for specific version\\" &&                 USE_CACHE=true;             fi;         fi &&                 if [ \\"$USE_CACHE\\" = \\"true\\" ]; then             echo \\"Found cached package: $CACHE_FILE\\" &&             CACHED_INFO=$(cat \\"$CACHE_INFO\\") &&             echo \\"Cached info: $CACHED_INFO\\" &&             cp \\"$CACHE_FILE\\" /tmp/cellframe-node.deb;         else             echo \\"Downloading fresh package...\\" &&                         if [ -n \\"$PACKAGE_URL\\" ]; then                 DOWNLOAD_URL=\\"$PACKAGE_URL\\";                 echo \\"Using provided URL: $DOWNLOAD_URL\\";             elif [ \\"$CELLFRAME_VERSION\\" = \\"latest\\" ]; then                 echo \\"Fetching latest version for architecture: $ARCH\\" &&                 LATEST_VERSION=$(wget -qO- http://pub.cellframe.net/linux/cellframe-node/master/ |                                 grep -oP \\"cellframe-node-\\\\K[0-9]+\\\\.[0-9]+-[0-9]+(?=${PACKAGE_SUFFIX}-${ARCH}\\\\.deb)\\" |                                 sort -V | tail -1);                 if [ -z \\"$LATEST_VERSION\\" ]; then                     echo \\"ERROR: No Cellframe Node packages found for architecture: $ARCH\\" &&                     echo \\"FAIL FAST: Check package availability or use specific version\\" &&                     exit 1;                 fi &&                 DOWNLOAD_URL=\\"http://pub.cellframe.net/linux/cellframe-node/master/cellframe-node-${LATEST_VERSION}${PACKAGE_SUFFIX}-${ARCH}.deb\\" &&                 ACTUAL_VERSION=\\"$LATEST_VERSION\\";             else                 DOWNLOAD_URL=\\"http://pub.cellframe.net/linux/cellframe-node/master/cellframe-node-${CELLFRAME_VERSION}${PACKAGE_SUFFIX}-${ARCH}.deb\\" &&                 ACTUAL_VERSION=\\"$CELLFRAME_VERSION\\";             fi &&                         echo \\"Download configuration:\\" &&             echo \\"  Hardware: $UNAME_ARCH\\" &&             echo \\"  Package arch: $ARCH\\" &&             echo \\"  Build type: $BUILD_TYPE (suffix: $PACKAGE_SUFFIX)\\" &&             echo \\"  Version: ${ACTUAL_VERSION:-$CELLFRAME_VERSION}\\" &&             echo \\"  URL: $DOWNLOAD_URL\\" &&                         echo \\"Downloading exact package for $ARCH architecture...\\" &&             wget -O /tmp/cellframe-node.deb \\"$DOWNLOAD_URL\\" || {                 echo \\"ERROR: Failed to download Cellframe Node package\\" &&                 echo \\"  URL: $DOWNLOAD_URL\\" &&                 echo \\"  Architecture: $ARCH\\" &&                 echo \\"  Version: ${ACTUAL_VERSION:-$CELLFRAME_VERSION}\\" &&                 echo \\"  Build type: $BUILD_TYPE\\" &&                 echo \\"FAIL FAST: No fallbacks - fix the configuration or package availability\\" &&                 exit 1;             } &&                         echo \\"Caching package for future use...\\" &&             cp /tmp/cellframe-node.deb \\"$CACHE_FILE\\" &&             echo \\"version=${ACTUAL_VERSION:-$CELLFRAME_VERSION},arch=${ARCH},build_type=${BUILD_TYPE},download_url=${DOWNLOAD_URL}\\" > \\"$CACHE_INFO\\" &&             date +%s > \\"$CACHE_TIMESTAMP\\" &&             echo \\"Cached at: $(date)\\";         fi;     elif [ \\"$NODE_SOURCE_TYPE\\" = \\"repository\\" ]; then         echo \\"ERROR: Repository source type not yet implemented in Dockerfile\\" &&         echo \\"  REPOSITORY_URL: $REPOSITORY_URL\\" &&         echo \\"  REPOSITORY_BRANCH: $REPOSITORY_BRANCH\\" &&         exit 1;     else         echo \\"ERROR: Unknown NODE_SOURCE_TYPE: $NODE_SOURCE_TYPE\\" &&         echo \\"Supported types: local, url, repository\\" &&         exit 1;     fi &&         echo \\"Installing Cellframe Node package...\\" &&     set +e &&     DEBIAN_FRONTEND=noninteractive dpkg -i --force-depends --force-confold /tmp/cellframe-node.deb 2>&1;     INSTALL_EXIT=$?;     set -e &&     if [ \\"$INSTALL_EXIT\\" -ne 0 ]; then         echo \\"Package installation had errors (exit code: $INSTALL_EXIT), fixing state...\\";         apt-get update -qq &&         DEBIAN_FRONTEND=noninteractive apt-get install -f -y -qq &&         DEBIAN_FRONTEND=noninteractive dpkg --configure -a 2>&1 || true;     else         apt-get update -qq &&         DEBIAN_FRONTEND=noninteractive apt-get install -f -y -qq;     fi &&     if [ -d \\"/opt/cellframe-node\\" ]; then         echo \\"Package installed successfully (postinst may have warnings)\\";     else         echo \\"ERROR: Package files not found after installation\\";         exit 1;     fi &&     rm /tmp/cellframe-node.deb" did not complete successfully: exit code: 1\n\n'
2025-12-15T17:26:41.008640Z [error    ] docker_up_failed               error="Command '['docker', 'compose', '-f', '/home/olzh/demlabs/second/cellframe-node/tests/stage-env/docker-compose.generated.yml', '-p', 'cellframe-stage', 'up', '-d', 'node-1', 'node-2', 'node-3', 'node-4', 'node-5', 'node-6']' returned non-zero exit status 1."
2025-12-15T17:26:41.008766Z [error    ] Docker operation failed: Command '['docker', 'compose', '-f', '/home/olzh/demlabs/second/cellframe-node/tests/stage-env/docker-compose.generated.yml', '-p', 'cellframe-stage', 'up', '-d', 'node-1', 'node-2', 'node-3', 'node-4', 'node-5', 'node-6']' returned non-zero exit status 1.
2025-12-15T17:26:41.014436Z [error    ] root_nodes_genesis_failed      error="Docker operation failed: Command '['docker', 'compose', '-f', '/home/olzh/demlabs/second/cellframe-node/tests/stage-env/docker-compose.generated.yml', '-p', 'cellframe-stage', 'up', '-d', 'node-1', 'node-2', 'node-3', 'node-4', 'node-5', 'node-6']' returned non-zero exit status 1.\nStep: docker_op='start' services=['root-1', 'root-2', 'root-3', 'master-1', 'master-2', 'master-3'] command=None detach=True wait_for_ip=True wait=None" traceback='Traceback (most recent call last):\n  File "/home/olzh/demlabs/second/cellframe-node/tests/stage-env/src/scenarios/step/docker_op.py", line 80, in execute\n    compose_manager.up(services=services, detach=step.detach, wait=False)\n  File "/home/olzh/demlabs/second/cellframe-node/tests/stage-env/src/docker/compose.py", line 552, in up\n    run_command(cmd, cwd=self.project_dir)\n  File "/home/olzh/demlabs/second/cellframe-node/tests/stage-env/src/utils/cli.py", line 95, in run_command\n    result = subprocess.run(\n             ^^^^^^^^^^^^^^^\n  File "/usr/lib/python3.12/subprocess.py", line 571, in run\n    raise CalledProcessError(retcode, process.args,\nsubprocess.CalledProcessError: Command \'[\'docker\', \'compose\', \'-f\', \'/home/olzh/demlabs/second/cellframe-node/tests/stage-env/docker-compose.generated.yml\', \'-p\', \'cellframe-stage\', \'up\', \'-d\', \'node-1\', \'node-2\', \'node-3\', \'node-4\', \'node-5\', \'node-6\']\' returned non-zero exit status 1.\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/home/olzh/demlabs/second/cellframe-node/tests/stage-env/src/network/manager.py", line 387, in start\n    ctx = await executor.execute_scenario(\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/olzh/demlabs/second/cellframe-node/tests/stage-env/src/scenarios/executor.py", line 449, in execute_scenario\n    await self._execute_steps(scenario.setup.steps, ctx, section_defaults)\n  File "/home/olzh/demlabs/second/cellframe-node/tests/stage-env/src/scenarios/executor.py", line 609, in _execute_steps\n    await self.docker_op_executor.execute(step, ctx)\n  File "/home/olzh/demlabs/second/cellframe-node/tests/stage-env/src/scenarios/step/docker_op.py", line 129, in execute\n    raise ScenarioExecutionError(error_msg, step=step)\nsrc.scenarios.executor.ScenarioExecutionError: Docker operation failed: Command \'[\'docker\', \'compose\', \'-f\', \'/home/olzh/demlabs/second/cellframe-node/tests/stage-env/docker-compose.generated.yml\', \'-p\', \'cellframe-stage\', \'up\', \'-d\', \'node-1\', \'node-2\', \'node-3\', \'node-4\', \'node-5\', \'node-6\']\' returned non-zero exit status 1.\nStep: docker_op=\'start\' services=[\'root-1\', \'root-2\', \'root-3\', \'master-1\', \'master-2\', \'master-3\'] command=None detach=True wait_for_ip=True wait=None\n'
