2025-12-14T06:04:13.449644Z [info     ] file_logging_enabled           log_file=/home/olzh/demlabs/second/cellframe-node/tests/stage-env/../testing/logs/stage-env_20251214_130413.log
2025-12-14T06:04:13.449858Z [warning  ] stale_pid_file_found           action=removing old_pid=21612
2025-12-14T06:04:13.576499Z [info     ] artifacts_manager_initialized  artifacts_dir=/home/olzh/demlabs/second/cellframe-node/tests/testing/artifacts collect_crash_dumps=True collect_health_logs=True collect_node_logs=True
2025-12-14T06:04:13.577636Z [info     ] loading_topology_from_template topology=default
2025-12-14T06:04:13.578126Z [info     ] loaded_config                  path=/home/olzh/demlabs/second/cellframe-node/tests/stage-env/config/stage-env.cfg
2025-12-14T06:04:13.582903Z [info     ] cert_generator_initialized     certs_dir=/home/olzh/demlabs/second/cellframe-node/tests/stage-env/cache/certs docker_mode=True
2025-12-14T06:04:13.599322Z [info     ] docker_connected               version=28.5.1
2025-12-14T06:04:13.716280Z [info     ] genesis_initializer_created    network=stagenet
2025-12-14T06:04:13.724449Z [info     ] artifacts_manager_initialized  artifacts_dir=/home/olzh/demlabs/second/cellframe-node/tests/testing/artifacts collect_crash_dumps=True collect_health_logs=True collect_node_logs=True
2025-12-14T06:04:13.727183Z [info     ] filesystem_mode_initialized    rsync_available=True snapshots_dir=/home/olzh/demlabs/second/cellframe-node/tests/testing/snapshots
2025-12-14T06:04:13.727312Z [info     ] snapshot_manager_initialized   base_path=/home/olzh/demlabs/second/cellframe-node/tests/stage-env config={'mode': 'filesystem', 'squashfs_compression': 'none', 'auto_create_on_startup': True, 'snapshot_name': 'clean_state', 'genesis_stage': 'full', 'phase1_snapshot_name': 'phase1_zerochain_genesis', 'auto_cleanup': True, 'keep_snapshot_count': 5, 'snapshots_dir': '../testing/snapshots', 'cache_dir': 'cache'} mode=filesystem
2025-12-14T06:04:13.727623Z [info     ] network_manager_initialized    cache_dir=cache network=stagenet snapshot_mode=filesystem timeouts={'startup': 600, 'health_check': 600, 'command': 30} topology=default
2025-12-14T06:04:13.727861Z [info     ] starting_network               rebuild=False topology=default
2025-12-14T06:04:13.727929Z [info     ] stopping_previous_environment 
2025-12-14T06:04:13.727986Z [info     ] stopping_services              remove_images=False volumes=False
2025-12-14T06:04:14.095002Z [info     ] services_stopped              
2025-12-14T06:04:14.095451Z [info     ] previous_environment_stopped  
2025-12-14T06:04:14.095612Z [info     ] cleanup_stale_resources        project=cellframe-stage
2025-12-14T06:04:14.106461Z [info     ] cleanup_completed             
2025-12-14T06:04:14.106639Z [info     ] phase1_snapshot_found_restoring mode=filesystem name=phase1_zerochain_genesis
2025-12-14T06:04:14.106706Z [info     ] restoring_snapshot             mode=filesystem name=phase1_zerochain_genesis
2025-12-14T06:04:14.106778Z [info     ] filesystem_restore_start       name=phase1_zerochain_genesis
2025-12-14T06:04:14.257987Z [error    ] filesystem_restore_failed      error='rsync failed: rsync: [generator] chgrp "/home/olzh/demlabs/second/cellframe-node/tests/stage-env/cache/data/node4/lib/global_db" failed: Operation not permitted (1)\nrsync: [generator] chgrp "/home/olzh/demlabs/second/cellframe-node/tests/stage-env/cache/data/node4/lib/global_db/gdb-mdbx" failed: Operation not permitted (1)\nrsync: [generator] chgrp "/home/olzh/demlabs/second/cellframe-node/tests/stage-env/cache/data/node4/log" failed: Operation not permitted (1)\nrsync: [generator] chgrp "/home/olzh/demlabs/second/cellframe-node/tests/stage-env/cache/data/node4/run" failed: Operation not permitted (1)\nrsync: [generator] chgrp "/home/olzh/demlabs/second/cellframe-node/tests/stage-env/cache/data/node4/run/node_cli" failed: Operation not permitted (1)\nrsync: [receiver] mkstemp "/home/olzh/demlabs/second/cellframe-node/tests/stage-env/cache/data/node4/log/.cellframe-node.log.tAUWOd" failed: Permission denied (13)\nrsync: [receiver] mkstemp "/home/olzh/demlabs/second/cellframe-node/tests/stage-env/cache/data/node4/run/.cellframe-node.pid.fZlPgH" failed: Permission denied (13)\nrsync error: some files/attrs were not transferred (see previous errors) (code 23) at main.c(1338) [sender=3.2.7]\n' name=phase1_zerochain_genesis
2025-12-14T06:04:14.258197Z [error    ] snapshot_restore_failed        name=phase1_zerochain_genesis
2025-12-14T06:04:14.258248Z [warning  ] phase1_snapshot_restore_failed_fallback_to_clean name=phase1_zerochain_genesis
2025-12-14T06:04:14.258281Z [info     ] cleaning_node_data_after_snapshot_restore_failed
2025-12-14T06:04:14.258387Z [info     ] removing_node_data_directories path=/home/olzh/demlabs/second/cellframe-node/tests/stage-env/cache/data
2025-12-14T06:04:14.258452Z [info     ] cleaning_cache_data_with_docker path=/home/olzh/demlabs/second/cellframe-node/tests/stage-env/cache/data
2025-12-14T06:04:14.664293Z [info     ] cache_data_cleaned             output='Cleanup complete'
2025-12-14T06:04:14.664456Z [info     ] node_data_removed             
2025-12-14T06:04:14.664686Z [info     ] node_data_cleaned_and_recreated nodes=0
2025-12-14T06:04:14.664770Z [info     ] generating_node_configs       
2025-12-14T06:04:14.664881Z [info     ] node_configs_generated         count=7 seed_nodes=3 validators=3
2025-12-14T06:04:14.664954Z [info     ] generating_configs_and_certs  
2025-12-14T06:04:14.665008Z [info     ] generating_configurations      force=False network=stagenet nodes=7
2025-12-14T06:04:14.667043Z [info     ] generating_certificates        count=7 force=False
2025-12-14T06:04:14.667190Z [info     ] generating_all_certificates    method=docker network=stagenet nodes=7 validators=3
• Generating 7 node certificates using Docker...
2025-12-14T06:04:14.696234Z [info     ] calling_docker_cert_generator  image=cf-cert-generator:latest network_id=0x1234 network_name=stagenet node_count=7 output_dir=/home/olzh/demlabs/second/cellframe-node/tests/stage-env/cache/certs
2025-12-14T06:04:15.116401Z [info     ] cert_generator_docker_output   stdout=
✓ Generated 7 node + 0 validator certificates
2025-12-14T06:04:15.118238Z [info     ] all_certificates_generated     nodes=7 validators=0
2025-12-14T06:04:15.120838Z [info     ] organizing_validator_certificates
2025-12-14T06:04:15.122269Z [info     ] copying_all_private_certs_to_root1_for_centralized_genesis
2025-12-14T06:04:15.122539Z [info     ] all_private_certs_copied_to_root1 additional_certs=2 note='root-1 can now perform centralized genesis with threshold consensus' own_cert=1 total_pvt_certs=3
2025-12-14T06:04:15.122990Z [info     ] distributing_public_certs_to_all_nodes network=stagenet total_nodes=7
2025-12-14T06:04:15.123387Z [info     ] public_certs_distributed_to_node master_certs=3 node_id=1 root_certs=3
2025-12-14T06:04:15.123792Z [info     ] public_certs_distributed_to_node master_certs=3 node_id=2 root_certs=3
2025-12-14T06:04:15.124175Z [info     ] public_certs_distributed_to_node master_certs=3 node_id=3 root_certs=3
2025-12-14T06:04:15.124555Z [info     ] public_certs_distributed_to_node master_certs=3 node_id=4 root_certs=3
2025-12-14T06:04:15.124936Z [info     ] public_certs_distributed_to_node master_certs=3 node_id=5 root_certs=3
2025-12-14T06:04:15.125328Z [info     ] public_certs_distributed_to_node master_certs=3 node_id=6 root_certs=3
2025-12-14T06:04:15.125693Z [info     ] public_certs_distributed_to_node master_certs=3 node_id=7 root_certs=3
2025-12-14T06:04:15.125759Z [info     ] certificates_generated         count=7
2025-12-14T06:04:15.129640Z [info     ] validator_addresses_collected  addresses=[BA7D::6334::45C5::C58A,2CC2::52D7::78A9::5DAA,D51... count=3
2025-12-14T06:04:15.129841Z [info     ] root_node_addresses_collected  addresses=[D2D5::4028::F94F::20F7,1046::9A39::7DAE::4D75,E13... count=3
2025-12-14T06:04:15.129971Z [info     ] validator_addresses_collected  addresses=[BA7D::6334::45C5::C58A,2CC2::52D7::78A9::5DAA,D51... count=3
2025-12-14T06:04:15.130038Z [info     ] mainchain_validators_configured master_validators_count=3 min_validators_count=2 note='Using master node addresses in validators_addrs for mainchain'
2025-12-14T06:04:15.130437Z [info     ] loaded_config                  path=/home/olzh/demlabs/second/cellframe-node/tests/stage-env/config/stage-env.cfg
2025-12-14T06:04:15.135464Z [info     ] configurations_generated       network=stagenet nodes=7
2025-12-14T06:04:15.135599Z [info     ] generating_docker_compose     
2025-12-14T06:04:15.136016Z [info     ] generating_compose_file        build_type=debug cache_dir=cache node_count=7 node_source_type=url
2025-12-14T06:04:15.160515Z [info     ] compose_file_generated         path=/home/olzh/demlabs/second/cellframe-node/tests/stage-env/docker-compose.generated.yml services=7
2025-12-14T06:04:15.160700Z [info     ] node_distribution              full=1 master=3 root=3
2025-12-14T06:04:15.160762Z [info     ] === PHASE 1: ROOT Nodes Startup (DAG-PoA Genesis) ===
2025-12-14T06:04:15.168756Z [info     ] network_consensus_monitor_initialized network=stagenet nodes=3
2025-12-14T06:04:15.185606Z [info     ] Loaded scenario: PHASE 1 - Zerochain Genesis from genesis/phase1_zerochain.yml
2025-12-14T06:04:15.196702Z [info     ] executing_phase1_scenario     
2025-12-14T06:04:15.196879Z [info     ] Starting scenario: PHASE 1 - Zerochain Genesis
2025-12-14T06:04:15.196932Z [info     ] Description: Initialize ROOT nodes, create token and emission
2025-12-14T06:04:15.197001Z [info     ] Executing setup phase...      
2025-12-14T06:04:15.197084Z [info     ] Step 1/4: ConfigStep (cellframe-node)
2025-12-14T06:04:15.197289Z [info     ] Config: regenerating 'cellframe-node' for nodes [0, 1, 2] with vars ['seed_mode']
2025-12-14T06:04:15.198377Z [info     ] cert_generator_initialized     certs_dir=/home/olzh/demlabs/second/cellframe-node/tests/stage-env/cache/certs docker_mode=True
2025-12-14T06:04:15.199397Z [warning  ] Target config file /home/olzh/demlabs/second/cellframe-node/tests/stage-env/cache/configs/node0/cellframe-node.cfg does not exist, skipping regeneration for node 0
2025-12-14T06:04:15.199711Z [info     ] Regenerated cellframe-node.cfg for node 1
2025-12-14T06:04:15.199949Z [info     ] Regenerated cellframe-node.cfg for node 2
2025-12-14T06:04:15.200018Z [info     ] Step 2/4: DockerOpStep        
2025-12-14T06:04:15.200092Z [info     ] Docker operation: start on services ['root-1', 'root-2', 'root-3', 'master-1', 'master-2', 'master-3']
2025-12-14T06:04:15.200161Z [info     ] starting_services              services=['root-0', 'root-1', 'root-2', 'master-0', 'master-1', 'master-2']
2025-12-14T06:04:15.944229Z [info     ] services_started              
2025-12-14T06:04:15.944621Z [info     ] waiting_for_container_ips      containers=['cellframe-stage-root-0', 'cellframe-stage-root-1', 'cellframe-stage-root-2', 'cellframe-stage-master-0', 'cellframe-stage-master-1', 'cellframe-stage-master-2']
2025-12-14T06:04:15.944725Z [info     ] waiting_for_container_ips      containers=['cellframe-stage-root-1', 'cellframe-stage-root-0', 'cellframe-stage-master-0', 'cellframe-stage-root-2', 'cellframe-stage-master-2', 'cellframe-stage-master-1'] timeout=30.0
2025-12-14T06:04:15.976729Z [info     ] all_containers_have_ips        count=6 elapsed=0.0
2025-12-14T06:04:15.976877Z [info     ] ✅ All containers have IP addresses count=6
2025-12-14T06:04:15.976927Z [info     ] ✅ Docker operation 'start' completed
2025-12-14T06:04:15.976968Z [info     ] Step 3/4: NetworkWaitStep     
2025-12-14T06:04:15.977024Z [info     ] Waiting for network state: online on nodes ['root-1', 'root-2', 'root-3', 'master-1', 'master-2', 'master-3']
2025-12-14T06:04:15.998899Z [info     ] waiting_for_nodes_online       node_count=6 timeout=60
2025-12-14T06:04:23.801014Z [info     ] node_state_check_during_wait   elapsed=10.2s node_id=8 note='Waiting for node to reach ONLINE state' state=UNKNOWN
2025-12-14T06:04:23.804429Z [info     ] node_state_check_during_wait   elapsed=10.2s node_id=1 note='Waiting for node to reach ONLINE state' state=UNKNOWN
2025-12-14T06:04:23.807388Z [info     ] node_state_check_during_wait   elapsed=10.2s node_id=2 note='Waiting for node to reach ONLINE state' state=UNKNOWN
2025-12-14T06:04:23.809882Z [info     ] node_state_check_during_wait   elapsed=10.2s node_id=8 note='Waiting for node to reach ONLINE state' state=UNKNOWN
2025-12-14T06:04:23.812377Z [info     ] node_state_check_during_wait   elapsed=10.2s node_id=4 note='Waiting for node to reach ONLINE state' state=UNKNOWN
2025-12-14T06:04:23.814974Z [info     ] node_state_check_during_wait   elapsed=10.2s node_id=5 note='Waiting for node to reach ONLINE state' state=UNKNOWN
2025-12-14T06:04:23.815086Z [info     ] nodes_online_progress          elapsed=10.2s online=0 total=6
2025-12-14T06:04:33.949278Z [info     ] node_state_check_during_wait   elapsed=20.3s node_id=8 note='Waiting for node to reach ONLINE state' state=UNKNOWN
2025-12-14T06:04:33.952674Z [info     ] node_state_check_during_wait   elapsed=20.3s node_id=1 note='Waiting for node to reach ONLINE state' state=UNKNOWN
2025-12-14T06:04:33.967402Z [info     ] node_state_check_during_wait   elapsed=20.3s node_id=2 note='Waiting for node to reach ONLINE state' state=UNKNOWN
2025-12-14T06:04:33.970087Z [info     ] node_state_check_during_wait   elapsed=20.3s node_id=8 note='Waiting for node to reach ONLINE state' state=UNKNOWN
2025-12-14T06:04:33.972806Z [info     ] node_state_check_during_wait   elapsed=20.3s node_id=4 note='Waiting for node to reach ONLINE state' state=UNKNOWN
2025-12-14T06:04:33.975512Z [info     ] node_state_check_during_wait   elapsed=20.3s node_id=5 note='Waiting for node to reach ONLINE state' state=UNKNOWN
2025-12-14T06:04:33.975650Z [info     ] nodes_online_progress          elapsed=20.3s online=0 total=6
2025-12-14T06:04:44.129598Z [info     ] node_state_check_during_wait   elapsed=30.5s node_id=8 note='Waiting for node to reach ONLINE state' state=UNKNOWN
2025-12-14T06:04:44.132370Z [info     ] node_state_check_during_wait   elapsed=30.5s node_id=1 note='Waiting for node to reach ONLINE state' state=UNKNOWN
2025-12-14T06:04:44.135616Z [info     ] node_state_check_during_wait   elapsed=30.5s node_id=2 note='Waiting for node to reach ONLINE state' state=UNKNOWN
2025-12-14T06:04:44.138961Z [info     ] node_state_check_during_wait   elapsed=30.5s node_id=8 note='Waiting for node to reach ONLINE state' state=UNKNOWN
2025-12-14T06:04:44.141613Z [info     ] node_state_check_during_wait   elapsed=30.5s node_id=4 note='Waiting for node to reach ONLINE state' state=UNKNOWN
2025-12-14T06:04:44.144302Z [info     ] node_state_check_during_wait   elapsed=30.5s node_id=5 note='Waiting for node to reach ONLINE state' state=UNKNOWN
2025-12-14T06:04:44.144440Z [info     ] nodes_online_progress          elapsed=30.5s online=0 total=6
2025-12-14T06:04:51.994857Z [info     ] node_state_check_during_wait   elapsed=40.6s node_id=8 note='Waiting for node to reach ONLINE state' state=UNKNOWN
2025-12-14T06:04:51.997776Z [info     ] node_state_check_during_wait   elapsed=40.6s node_id=1 note='Waiting for node to reach ONLINE state' state=UNKNOWN
2025-12-14T06:04:52.000471Z [info     ] node_state_check_during_wait   elapsed=40.6s node_id=2 note='Waiting for node to reach ONLINE state' state=UNKNOWN
2025-12-14T06:04:52.003073Z [info     ] node_state_check_during_wait   elapsed=40.6s node_id=8 note='Waiting for node to reach ONLINE state' state=UNKNOWN
2025-12-14T06:04:52.005881Z [info     ] node_state_check_during_wait   elapsed=40.6s node_id=4 note='Waiting for node to reach ONLINE state' state=UNKNOWN
2025-12-14T06:04:52.008619Z [info     ] node_state_check_during_wait   elapsed=40.6s node_id=5 note='Waiting for node to reach ONLINE state' state=UNKNOWN
2025-12-14T06:04:52.008744Z [info     ] nodes_online_progress          elapsed=40.6s online=0 total=6
2025-12-14T06:05:02.268461Z [info     ] node_state_check_during_wait   elapsed=50.9s node_id=8 note='Waiting for node to reach ONLINE state' state=UNKNOWN
2025-12-14T06:05:02.272171Z [info     ] node_state_check_during_wait   elapsed=50.9s node_id=1 note='Waiting for node to reach ONLINE state' state=UNKNOWN
2025-12-14T06:05:02.274760Z [info     ] node_state_check_during_wait   elapsed=50.9s node_id=2 note='Waiting for node to reach ONLINE state' state=UNKNOWN
2025-12-14T06:05:02.277422Z [info     ] node_state_check_during_wait   elapsed=50.9s node_id=8 note='Waiting for node to reach ONLINE state' state=UNKNOWN
2025-12-14T06:05:02.280007Z [info     ] node_state_check_during_wait   elapsed=50.9s node_id=4 note='Waiting for node to reach ONLINE state' state=UNKNOWN
2025-12-14T06:05:02.282414Z [info     ] node_state_check_during_wait   elapsed=50.9s node_id=5 note='Waiting for node to reach ONLINE state' state=UNKNOWN
2025-12-14T06:05:02.282538Z [info     ] nodes_online_progress          elapsed=50.9s online=0 total=6
2025-12-14T06:05:12.496528Z [error    ] nodes_online_timeout           elapsed=61.1s missing=6 online=0 total=6
2025-12-14T06:05:12.501196Z [error    ] failed_to_collect_node_diagnostics error='404 Client Error for http+docker://localhost/v1.51/containers/cellframe-stage-node-8/json: Not Found ("No such container: cellframe-stage-node-8")' node_id=8
2025-12-14T06:05:12.504606Z [error    ] failed_to_collect_node_diagnostics error='404 Client Error for http+docker://localhost/v1.51/containers/cellframe-stage-node-1/json: Not Found ("No such container: cellframe-stage-node-1")' node_id=1
2025-12-14T06:05:12.507692Z [error    ] failed_to_collect_node_diagnostics error='404 Client Error for http+docker://localhost/v1.51/containers/cellframe-stage-node-2/json: Not Found ("No such container: cellframe-stage-node-2")' node_id=2
2025-12-14T06:05:12.510715Z [error    ] failed_to_collect_node_diagnostics error='404 Client Error for http+docker://localhost/v1.51/containers/cellframe-stage-node-8/json: Not Found ("No such container: cellframe-stage-node-8")' node_id=8
2025-12-14T06:05:12.513860Z [error    ] failed_to_collect_node_diagnostics error='404 Client Error for http+docker://localhost/v1.51/containers/cellframe-stage-node-4/json: Not Found ("No such container: cellframe-stage-node-4")' node_id=4
2025-12-14T06:05:12.516879Z [error    ] failed_to_collect_node_diagnostics error='404 Client Error for http+docker://localhost/v1.51/containers/cellframe-stage-node-5/json: Not Found ("No such container: cellframe-stage-node-5")' node_id=5
2025-12-14T06:05:12.517002Z [error    ] Network wait failed: Nodes failed to reach ONLINE state after 61.1s. Only 0/6 nodes are online.
2025-12-14T06:05:12.530174Z [error    ] root_nodes_genesis_failed      error="Network wait failed: Nodes failed to reach ONLINE state after 61.1s. Only 0/6 nodes are online.\nStep: wait_network='online' nodes=['root-1', 'root-2', 'root-3', 'master-1', 'master-2', 'master-3'] timeout=60 network='stagenet' chain=None" traceback='Traceback (most recent call last):\n  File "/home/olzh/demlabs/second/cellframe-node/tests/stage-env/src/scenarios/step/network_wait.py", line 66, in execute\n    await state_manager.wait_for_nodes_online(node_configs, timeout=step.timeout)\n  File "/home/olzh/demlabs/second/cellframe-node/tests/stage-env/src/network/node_states.py", line 151, in wait_for_nodes_online\n    raise TimeoutError(\nTimeoutError: Nodes failed to reach ONLINE state after 61.1s. Only 0/6 nodes are online.\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/home/olzh/demlabs/second/cellframe-node/tests/stage-env/src/network/manager.py", line 394, in start\n    ctx = await executor.execute_scenario(\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/olzh/demlabs/second/cellframe-node/tests/stage-env/src/scenarios/executor.py", line 442, in execute_scenario\n    await self._execute_steps(scenario.setup.steps, ctx, section_defaults)\n  File "/home/olzh/demlabs/second/cellframe-node/tests/stage-env/src/scenarios/executor.py", line 600, in _execute_steps\n    await self.network_wait_executor.execute(step, ctx)\n  File "/home/olzh/demlabs/second/cellframe-node/tests/stage-env/src/scenarios/step/network_wait.py", line 126, in execute\n    raise ScenarioExecutionError(error_msg, step=step)\nsrc.scenarios.executor.ScenarioExecutionError: Network wait failed: Nodes failed to reach ONLINE state after 61.1s. Only 0/6 nodes are online.\nStep: wait_network=\'online\' nodes=[\'root-1\', \'root-2\', \'root-3\', \'master-1\', \'master-2\', \'master-3\'] timeout=60 network=\'stagenet\' chain=None\n'
2025-12-14T06:05:12.530398Z [info     ] keep_running_enabled_containers_not_stopped phase=Phase1
