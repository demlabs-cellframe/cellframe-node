# Common: Create Token with Emission
# Unified setup for token declaration + emission
# Variables: 
#   - token_name (required)
#   - total_supply (default: 1000000)
#   - emission_value (required)
#   - wallet_addr (required)
#   - network_name (default: stagenet)
#   - flags (default: none)
# Output: token_hash, emission_hash variables

setup:
  # Declare token
  - cli: token_decl -net {{network_name|stagenet}} -token {{token_name}} -total {{total_supply|1000000}} {{flags}}
    node: "{{target_node|node1}}"
    save: token_hash
  
  # Emit tokens
  - cli: token_emit -net {{network_name|stagenet}} -token {{token_name}} -value {{emission_value}} -addr {{wallet_addr}}
    node: "{{target_node|node1}}"
    save: emission_hash
  
  # Wait for propagation
  - wait_for_datum: "{{emission_hash}}"
    network: "{{network_name|stagenet}}"

