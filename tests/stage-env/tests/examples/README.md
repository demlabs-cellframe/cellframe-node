# Test Examples

–≠—Ç–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —Å–æ–¥–µ—Ä–∂–∏—Ç **–ø—Ä–∏–º–µ—Ä—ã** —Ç–µ—Å—Ç–æ–≤—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤, –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—â–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ stage-env.

## ‚ö†Ô∏è –í–∞–∂–Ω–æ

–ü—Ä–∏–º–µ—Ä—ã **–ù–ï –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏** –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ `./tests/run.sh`.

–û–Ω–∏ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω—ã –¥–ª—è:
- üìö –û–±—É—á–µ–Ω–∏—è –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
- üî¨ –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ —Å –Ω–æ–≤—ã–º–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º–∏
- üìã –®–∞–±–ª–æ–Ω–æ–≤ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤
- üß™ –†—É—á–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ —Ñ—É–Ω–∫—Ü–∏–π

## –ó–∞–ø—É—Å–∫ –ø—Ä–∏–º–µ—Ä–æ–≤

### –ó–∞–ø—É—Å–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø—Ä–∏–º–µ—Ä–∞:
```bash
cd tests/stage-env
./stage_env.py run-tests tests/examples/test_vpn_node.yml
```

### –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö –ø—Ä–∏–º–µ—Ä–æ–≤:
```bash
cd tests/stage-env
./stage_env.py run-tests tests/examples/
```

## –î–æ—Å—Ç—É–ø–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã

### 1. `test_vpn_node.yml`
**–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è:** Docker customizations –¥–ª—è VPN —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚úÖ NET_ADMIN capabilities
- ‚úÖ TUN/TAP —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ
- ‚úÖ Sysctls (IP forwarding)
- ‚úÖ Custom packages (WireGuard, OpenVPN)
- ‚úÖ Asymmetric topology (—Å–µ—Ä–≤–µ—Ä + –∫–ª–∏–µ–Ω—Ç)

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- –°–æ–∑–¥–∞–Ω–∏–µ VPN –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤ –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ç–µ–≤—ã—Ö capabilities
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç—É–Ω–Ω–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è

### 2. `test_version_compatibility.yml`
**–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è:** Per-node package sources
- ‚úÖ –†–∞–∑–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö –Ω–æ–¥–∞—Ö
- ‚úÖ URL, local, repository –∏—Å—Ç–æ—á–Ω–∏–∫–∏
- ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ –≤–µ—Ä—Å–∏–π
- ‚úÖ –°–º–µ—à–∞–Ω–Ω—ã–µ —Å–±–æ—Ä–∫–∏ (debug + release)

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π –º–µ–∂–¥—É –≤–µ—Ä—Å–∏—è–º–∏
- –°–∏–º—É–ª—è—Ü–∏—è –≥–µ—Ç–µ—Ä–æ–≥–µ–Ω–Ω–æ–π —Å–µ—Ç–∏

### 3. `test_defaults_and_groups.yml`
**–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è:** Hierarchical defaults –∏ step grouping
- ‚úÖ Global defaults
- ‚úÖ Section-level defaults
- ‚úÖ Group-level defaults
- ‚úÖ Nested groups
- ‚úÖ Defaults inheritance and override

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- –ú–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–¥–∞
- –õ–æ–≥–∏—á–µ—Å–∫–∞—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ —à–∞–≥–æ–≤
- –ì–∏–±–∫–æ–µ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

## –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–∏–º–µ—Ä—ã –∫–∞–∫ —à–∞–±–ª–æ–Ω—ã:

1. **–°–∫–æ–ø–∏—Ä—É–π—Ç–µ** –ø–æ–¥—Ö–æ–¥—è—â–∏–π –ø—Ä–∏–º–µ—Ä
2. **–ê–¥–∞–ø—Ç–∏—Ä—É–π—Ç–µ** –ø–æ–¥ –≤–∞—à–∏ –Ω—É–∂–¥—ã
3. **–†–∞–∑–º–µ—Å—Ç–∏—Ç–µ** –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏:
   - `tests/e2e/` - —Å–∫–≤–æ–∑–Ω—ã–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
   - `tests/functional/` - —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã
   - `tests/stage-env/tests/base/` - –±–∞–∑–æ–≤—ã–µ —Ç–µ—Å—Ç—ã –æ–∫—Ä—É–∂–µ–Ω–∏—è

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–∏–º–µ—Ä–∞

```yaml
name: "Test Name"
description: "What this test does"

network:
  topology: minimal
  nodes:
    - name: node1
      role: root
      # Customizations here

defaults:
  node: node1
  wait: 2s

setup:
  - cli: "version"

test:
  - group:
      description: "Test group"
      steps:
        - cli: "command"

check:
  - cli: "stats"
    expect: success
```

## –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [Scenario Language Guide](../../docs/ru/scenarios/Glossary.md)
- [Defaults & Groups](../../docs/ru/scenarios/Defaults-And-Groups.md)
- [Per-Node Packages](../../docs/en/Per-Node-Packages.md)
- [Docker Customizations](../../config/stage-env.cfg.default#L340)

## –í–æ–ø—Ä–æ—Å—ã?

–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ–ø–æ–Ω—è—Ç–Ω–æ –∏–ª–∏ –Ω—É–∂–Ω—ã –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã:
1. –ò–∑—É—á–∏—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–µ—Å—Ç—ã –≤ `tests/e2e/` –∏ `tests/functional/`
2. –ü—Ä–æ—á–∏—Ç–∞–π—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –≤ `tests/stage-env/docs/`
3. –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏!

