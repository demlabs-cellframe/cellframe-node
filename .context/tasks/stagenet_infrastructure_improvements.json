{
  "task_id": "stagenet_infrastructure_improvements_20251023",
  "type": "infrastructure",
  "domain": "testing_infrastructure",
  "priority": "high",
  "status": "in_progress",
  "created": "2025-10-23T12:50:00Z",
  "updated": "2025-10-24T15:28:00Z",
  
  "auto_load": [
    ".context/modules/standards/dap_sdk_coding_standards.json",
    ".context/modules/projects/cellframe_sdk.json",
    ".context/modules/projects/cellframe_stage_env.json"
  ],
  
  "title": "Stagenet Infrastructure Improvements - Continued",
  "description": "Continue improving stagenet testing infrastructure with focus on logging, configuration, and customization",
  
  "objectives": [
    "–£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –ø—É—Ç–µ–π –≤ –∫–æ–Ω—Ñ–∏–≥–µ",
    "–û—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å –ª–æ–≥–∏ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –≤ run_* –ø–∞–ø–∫–∞—Ö",
    "–†–∞—Å—à–∏—Ä–∏—Ç—å –ª–æ–≥–∏ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ —Å –∫–æ–º–∞–Ω–¥–∞–º–∏ –∏ –æ—Ç–≤–µ—Ç–∞–º–∏ –Ω–æ–¥",
    "–î–æ–±–∞–≤–∏—Ç—å –∫–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—é Docker –æ–±—Ä–∞–∑–æ–≤",
    "–î–æ–±–∞–≤–∏—Ç—å –∫–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—é –≤ —è–∑—ã–∫ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤",
    "–ü–æ–¥–¥–µ—Ä–∂–∫–∞ custom deb repositories"
  ],
  
  "phases": [
    {
      "id": "phase_paths_unification",
      "name": "–£–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è –ø—É—Ç–µ–π –≤ –∫–æ–Ω—Ñ–∏–≥–µ",
      "status": "completed",
      "description": "–í—Å–µ –ø—É—Ç–∏ (log_dir, cache_dir, artifacts_dir) —Ä–∞–∑—Ä–µ—à–∞—é—Ç—Å—è –æ—Ç BASE_PATH (stage-env/)",
      "solution": "–í—Å–µ –ø—É—Ç–∏ —Ä–∞–∑—Ä–µ—à–∞—é—Ç—Å—è –æ—Ç BASE_PATH –¥–ª—è –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–∏—è",
      "tasks": [
        {
          "id": "1.1",
          "description": "–ò—Å–ø—Ä–∞–≤–∏—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ log_dir –≤ stage_env.py",
          "status": "completed",
          "files": [
            "tests/stage-env/stage_env.py::70-83 (setup logging)",
            "tests/stage-env/stage_env.py::794-804 (collect_artifacts)"
          ],
          "changes": "–ò–∑–º–µ–Ω–µ–Ω–æ —Å CONFIG_PATH.parent –Ω–∞ BASE_PATH"
        },
        {
          "id": "1.2",
          "description": "–ò—Å–ø—Ä–∞–≤–∏—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ cache_dir –≤ genesis.py",
          "status": "completed",
          "files": [
            "tests/stage-env/src/network/genesis.py::36-42"
          ],
          "changes": "–£–±—Ä–∞–Ω–∞ —É—Å–ª–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Å CONFIG_PATH.parent, —Ç–µ–ø–µ—Ä—å –≤—Å–µ–≥–¥–∞ BASE_PATH"
        },
        {
          "id": "1.3",
          "description": "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å stage-env.cfg",
          "status": "completed",
          "result": "–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —É–∂–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞",
          "paths": {
            "log_dir": "../testing/logs (–æ—Ç BASE_PATH)",
            "cache_dir": "../testing/cache (–æ—Ç BASE_PATH)",
            "artifacts_dir": "../testing/artifacts (–æ—Ç BASE_PATH)"
          },
          "note": "–í—Å–µ –ø—É—Ç–∏ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ –æ—Ç BASE_PATH = /tests/stage-env/"
        }
      ],
      "verification": {
        "BASE_PATH": "/home/naeper/work/cellframe-node/tests/stage-env",
        "resolved_paths": {
          "log_dir": "/home/naeper/work/cellframe-node/tests/testing/logs",
          "cache_dir": "/home/naeper/work/cellframe-node/tests/testing/cache",
          "artifacts_dir": "/home/naeper/work/cellframe-node/tests/testing/artifacts"
        },
        "consistency": "‚úÖ –í—Å–µ –ø—É—Ç–∏ —Ç–µ–ø–µ—Ä—å –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω–æ —Ä–∞–∑—Ä–µ—à–∞—é—Ç—Å—è –æ—Ç BASE_PATH"
      }
    },
    {
      "id": "phase_scenario_logs_organization",
      "name": "–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –ª–æ–≥–æ–≤ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤",
      "status": "completed",
      "description": "–ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å scenario-logs/ –≤–Ω—É—Ç—Ä—å run_* –ø–∞–ø–æ–∫",
      "before": "testing/artifacts/scenario-logs/*.log",
      "after": "testing/artifacts/run_tests_*/scenario-logs/*.log",
      "tasks": [
        {
          "id": "2.1",
          "description": "–°–æ–∑–¥–∞–≤–∞—Ç—å run_* –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –≤ –Ω–∞—á–∞–ª–µ run_tests",
          "status": "completed",
          "file": "tests/stage-env/stage_env.py::run_tests",
          "changes": [
            "–î–æ–±–∞–≤–ª–µ–Ω –∏–º–ø–æ—Ä—Ç ArtifactsManager",
            "–°–æ–∑–¥–∞–Ω–∏–µ run_dir –≤ –Ω–∞—á–∞–ª–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Å run_id='tests_{timestamp}'",
            "–í—ã–≤–æ–¥ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å–æ–∑–¥–∞–Ω–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏"
          ]
        },
        {
          "id": "2.2",
          "description": "–ò–∑–º–µ–Ω–∏—Ç—å –ø—É—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ª–æ–≥–æ–≤ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤",
          "status": "completed",
          "file": "tests/stage-env/stage_env.py::474-486",
          "change": "scenario_logs_dir = run_dir / 'scenario-logs' –≤–º–µ—Å—Ç–æ artifacts_dir / 'scenario-logs'"
        },
        {
          "id": "2.3",
          "description": "–î–æ–±–∞–≤–∏—Ç—å scenario-logs –≤ —Å–ø–∏—Å–æ–∫ subdirs –≤ ArtifactsManager",
          "status": "completed",
          "file": "tests/stage-env/src/utils/artifacts.py::76-85",
          "change": "–î–æ–±–∞–≤–ª–µ–Ω 'scenario-logs' –≤ —Å–ø–∏—Å–æ–∫ —Å–æ–∑–¥–∞–≤–∞–µ–º—ã—Ö –ø–æ–¥–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π"
        }
      ],
      "result": {
        "structure": "artifacts/run_tests_20251024_120000/scenario-logs/scenario_*.log",
        "benefits": [
          "–õ–æ–≥–∏ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –≥—Ä—É–ø–ø–∏—Ä—É—é—Ç—Å—è –ø–æ –∑–∞–ø—É—Å–∫–∞–º",
          "–õ–µ–≥–∫–æ –Ω–∞–π—Ç–∏ –≤—Å–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞",
          "–ö–æ—Ä–Ω–µ–≤–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è artifacts/ –æ—Å—Ç–∞—ë—Ç—Å—è —á–∏—Å—Ç–æ–π"
        ]
      }
    },
    {
      "id": "phase_extended_scenario_logs",
      "name": "–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –ª–æ–≥–∏ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤",
      "status": "completed",
      "description": "–õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –∫–æ–º–∞–Ω–¥—ã CLI/RPC –∏ –ø–æ–ª–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã –Ω–æ–¥ –≤ –ª–æ–≥–∏ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤",
      "implementation": "–î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –≤ ScenarioExecutor",
      "tasks": [
        {
          "id": "3.1",
          "description": "–î–æ–±–∞–≤–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ CLI –∫–æ–º–∞–Ω–¥",
          "status": "completed",
          "file": "tests/stage-env/src/scenarios/executor.py::196-269",
          "implementation": [
            "–î–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ _log_to_file() –¥–ª—è –∑–∞–ø–∏—Å–∏ –≤ –ª–æ–≥",
            "–õ–æ–≥–∏—Ä—É–µ—Ç—Å—è: Node, Command, Description, Timeout, Expected",
            "–û—Ç–≤–µ—Ç: Exit Code, Stdout, Stderr",
            "–û—Ç–º–µ—Ç–∫–∞ –æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö",
            "–û—Ç–º–µ—Ç–∫–∞ –æ —Ç–∞–π–º–∞—É—Ç–∞—Ö"
          ]
        },
        {
          "id": "3.2",
          "description": "–î–æ–±–∞–≤–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ RPC –∑–∞–ø—Ä–æ—Å–æ–≤",
          "status": "completed",
          "file": "tests/stage-env/src/scenarios/executor.py::271-331",
          "implementation": [
            "–õ–æ–≥–∏—Ä—É–µ—Ç—Å—è: Node, Method, Params, Description, Timeout, Expected",
            "–û—Ç–≤–µ—Ç: Full JSON response (formatted)",
            "–û—Ç–º–µ—Ç–∫–∞ –æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö",
            "–û—Ç–º–µ—Ç–∫–∞ –æ —Ç–∞–π–º–∞—É—Ç–∞—Ö"
          ]
        },
        {
          "id": "3.3",
          "description": "–î–æ–±–∞–≤–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä log_file –≤ ScenarioExecutor",
          "status": "completed",
          "file": "tests/stage-env/src/scenarios/executor.py::100-116",
          "changes": [
            "–î–æ–±–∞–≤–ª–µ–Ω Optional[Path] log_file –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä",
            "–î–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ _log_to_file() –¥–ª—è –∑–∞–ø–∏—Å–∏"
          ]
        },
        {
          "id": "3.4",
          "description": "–ü–µ—Ä–µ–¥–∞–≤–∞—Ç—å scenario_log_file –≤ executor",
          "status": "completed",
          "file": "tests/stage-env/stage_env.py::511",
          "change": "ScenarioExecutor(node_cli_path=cli_path, log_file=scenario_log_file)"
        }
      ],
      "result": {
        "log_format_cli": "=== CLI COMMAND ===\nNode: node1\nCommand: wallet list\nTimeout: 30s\n\n--- Node Response ---\nExit Code: 0\nStdout: wallet1\nwallet2",
        "log_format_rpc": "=== RPC CALL ===\nNode: node1\nMethod: net.status\nParams: []\n\n--- Node Response ---\n{\n  \"result\": {...}\n}",
        "benefits": [
          "–ü–æ–ª–Ω–∞—è —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞ –≤—Å–µ—Ö –∫–æ–º–∞–Ω–¥ –∏ –æ—Ç–≤–µ—Ç–æ–≤",
          "–õ–µ–≥–∫–æ –æ—Ç–ª–∞–∂–∏–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã –≤ —Ç–µ—Å—Ç–∞—Ö",
          "–í–∏–¥–Ω–æ —Ä–µ–∞–ª—å–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –Ω–æ–¥",
          "–§–æ—Ä–º–∞—Ç —É–¥–æ–±–Ω—ã–π –¥–ª—è —á—Ç–µ–Ω–∏—è —á–µ–ª–æ–≤–µ–∫–æ–º"
        ]
      }
    },
    {
      "id": "phase_docker_customization_config",
      "name": "–ö–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è Docker –æ–±—Ä–∞–∑–æ–≤ –≤ –∫–æ–Ω—Ñ–∏–≥–µ",
      "status": "completed",
      "description": "–î–æ–±–∞–≤–ª–µ–Ω—ã —Å–µ–∫—Ü–∏–∏ –∫–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏–∏ –≤ stage-env.cfg –∫–∞–∫ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ–ø—Ü–∏–∏",
      "implementation_status": "documented_for_future",
      "tasks": [
        {
          "id": "4.1",
          "description": "–î–æ–±–∞–≤–∏—Ç—å –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Å–µ–∫—Ü–∏—é [docker_customization]",
          "status": "completed",
          "section": "base_packages, base_post_script",
          "location": "tests/stage-env.cfg::58-62"
        },
        {
          "id": "4.2",
          "description": "–î–æ–±–∞–≤–∏—Ç—å —Å–µ–∫—Ü–∏–∏ [role_customization_*]",
          "status": "completed",
          "sections": "root, master, full - packages, post_script",
          "location": "tests/stage-env.cfg::64-80"
        },
        {
          "id": "4.3",
          "description": "–î–æ–±–∞–≤–∏—Ç—å —Å–µ–∫—Ü–∏–∏ [node_customization_node*]",
          "status": "completed",
          "sections": "node1, node2... - packages, deb_urls, post_script",
          "location": "tests/stage-env.cfg::82-93"
        },
        {
          "id": "4.4",
          "description": "–î–æ–±–∞–≤–∏—Ç—å —Å–µ–∫—Ü–∏–∏ [repository_*] –¥–ª—è custom deb repos",
          "status": "completed",
          "location": "tests/stage-env.cfg::95-112",
          "note": "–û–±—ä–µ–¥–∏–Ω–µ–Ω–æ —Å –∑–∞–¥–∞—á–µ–π 6"
        }
      ],
      "config_sections": {
        "docker_customization": {
          "base_packages": "–ü–∞–∫–µ—Ç—ã –¥–ª—è –≤—Å–µ—Ö –Ω–æ–¥ (vim,curl,htop,net-tools,strace)",
          "base_post_script": "–°–∫—Ä–∏–ø—Ç –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –±–∞–∑–æ–≤—ã—Ö –ø–∞–∫–µ—Ç–æ–≤"
        },
        "role_customization_<role>": {
          "packages": "–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞–∫–µ—Ç—ã –¥–ª—è —Ä–æ–ª–∏ (root/master/full)",
          "post_script": "–°–∫—Ä–∏–ø—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–ª—è —Ä–æ–ª–∏"
        },
        "node_customization_<node_id>": {
          "packages": "–ü–∞–∫–µ—Ç—ã –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –Ω–æ–¥—ã",
          "deb_urls": "URL .deb –ø–∞–∫–µ—Ç–æ–≤ –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏",
          "post_script": "–°–∫—Ä–∏–ø—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –Ω–æ–¥—ã"
        },
        "repository_<name>": {
          "name": "–ò–º—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è",
          "url": "URL —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è",
          "key_url": "URL GPG –∫–ª—é—á–∞",
          "components": "–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (main restricted)",
          "distribution": "–î–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤ (jammy)"
        }
      },
      "future_implementation": {
        "required_changes": [
          "–ú–µ—Ç–æ–¥—ã –≤ ConfigLoader –¥–ª—è —á—Ç–µ–Ω–∏—è —Å–µ–∫—Ü–∏–π –∫–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏–∏",
          "–ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è Dockerfile –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è ARG –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤",
          "DockerComposeManager: –ø–µ—Ä–µ–¥–∞—á–∞ build args",
          "–í–∞–ª–∏–¥–∞—Ü–∏—è –ø—É—Ç–µ–π –∫ —Å–∫—Ä–∏–ø—Ç–∞–º –∏ URL",
          "–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–∞–∫–µ—Ç–æ–≤"
        ],
        "estimated_effort": "2-3 –¥–Ω—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ + —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ"
      },
      "note": "–°–µ–∫—Ü–∏–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã –∫–∞–∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å, –Ω–æ –¥–ª—è —ç—Ç–æ–≥–æ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –≤ –∫–æ–¥–µ."
    },
    {
      "id": "phase_scenario_customization",
      "name": "–ö–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è –≤ —è–∑—ã–∫–µ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤",
      "status": "completed",
      "description": "–ó–∞–¥–∞—á–∞ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∞ —Å phase_docker_customization_config",
      "note": "–ö–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è –≤ —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–µ –∂–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã —á—Ç–æ –∏ –≤ –∫–æ–Ω—Ñ–∏–≥–µ. –°–µ–∫—Ü–∏–∏ —É–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ stage-env.cfg."
    },
    {
      "id": "phase_custom_repositories",
      "name": "–ü–æ–¥–¥–µ—Ä–∂–∫–∞ custom deb repositories",
      "status": "completed",
      "description": "–ó–∞–¥–∞—á–∞ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∞ —Å phase_docker_customization_config",
      "location": "tests/stage-env.cfg::95-112",
      "note": "–°–µ–∫—Ü–∏–∏ [repository_*] –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ stage-env.cfg –∫–∞–∫ —á–∞—Å—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –∫–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏–∏."
    },
    {
      "id": "phase_wait_for_datum_helper",
      "name": "Wait-for-Datum Helper –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –¥–∞—Ç—É–º–æ–≤",
      "status": "in_progress",
      "priority": "high",
      "description": "–ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π —Ö–µ–ª–ø–µ—Ä –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è –¥–∞—Ç—É–º–∞ —á–µ—Ä–µ–∑ –≤—Å–µ —ç—Ç–∞–ø—ã: mempool ‚Üí verification ‚Üí blocks ‚Üí propagation",
      "motivation": "–ù—É–∂–µ–Ω —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º –æ–∂–∏–¥–∞–Ω–∏—è –ø–æ–ø–∞–¥–∞–Ω–∏—è –¥–∞—Ç—É–º–æ–≤ –≤ —á–µ–π–Ω —Å –¥–µ—Ç–∞–ª—å–Ω–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–æ–π –ø—Ä–æ–±–ª–µ–º –Ω–∞ –∫–∞–∂–¥–æ–º —ç—Ç–∞–ø–µ",
      "subphases": [
        {
          "id": "7.1",
          "name": "–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ —Å—Ö–µ–º–∞",
          "status": "pending",
          "tasks": [
            {
              "id": "7.1.1",
              "description": "–°–æ–∑–¥–∞—Ç—å WaitForDatumStep –º–æ–¥–µ–ª—å –≤ schema.py",
              "status": "pending",
              "details": {
                "fields": [
                  "datum_hash: Union[str, List[str]] - —Ö—ç—à(–∏) –¥–∞—Ç—É–º–∞ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è",
                  "node: str - –Ω–æ–¥–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: node1)",
                  "check_master_nodes: bool = True - –ø—Ä–æ–≤–µ—Ä—è—Ç—å –Ω–∞ master –Ω–æ–¥–∞—Ö –Ω–∞–ø—Ä—è–º—É—é",
                  "timeout_total: int = 300 - –æ–±—â–∏–π —Ç–∞–π–º–∞—É—Ç (—Å–µ–∫)",
                  "timeout_mempool: int = 60 - —Ç–∞–π–º–∞—É—Ç –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è –≤ mempool",
                  "timeout_verification: int = 120 - —Ç–∞–π–º–∞—É—Ç –ø–æ—Å–ª–µ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏",
                  "timeout_in_blocks: int = 180 - —Ç–∞–π–º–∞—É—Ç –ø–æ—Å–ª–µ –ø–æ–ø–∞–¥–∞–Ω–∏—è –≤ –±–ª–æ–∫–∏",
                  "check_interval: int = 2 - –∏–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–æ–≤–µ—Ä–∫–∏ (—Å–µ–∫)",
                  "save_status: Optional[str] - —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å—Ç–∞—Ç—É—Å –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é"
                ],
                "file": "tests/stage-env/src/scenarios/schema.py"
              }
            },
            {
              "id": "7.1.2",
              "description": "–î–æ–±–∞–≤–∏—Ç—å WaitForDatumStep –≤ Union[TestStep]",
              "status": "pending",
              "file": "tests/stage-env/src/scenarios/schema.py::230",
              "change": "TestStep = Union[CLIStep, RPCStep, WaitStep, WaitForDatumStep, PythonStep, BashStep, LoopStep, StepGroup]"
            },
            {
              "id": "7.1.3",
              "description": "–°–æ–∑–¥–∞—Ç—å DatumStatus enum –¥–ª—è —Å–æ—Å—Ç–æ—è–Ω–∏–π –¥–∞—Ç—É–º–∞",
              "status": "pending",
              "details": {
                "states": [
                  "NOT_FOUND - –¥–∞—Ç—É–º –Ω–µ –Ω–∞–π–¥–µ–Ω –Ω–∏–≥–¥–µ",
                  "IN_MEMPOOL - –≤ mempool, –æ–∂–∏–¥–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏",
                  "VERIFIED - –ø—Ä–æ—à–µ–ª –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—é –º–∞—Å—Ç–µ—Ä-–Ω–æ–¥–∞–º–∏",
                  "IN_BLOCKS - –ø–æ–ø–∞–ª –≤ –±–ª–æ–∫–∏",
                  "PROPAGATED - –±–ª–æ–∫–∏ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–∏–ª–∏—Å—å –Ω–∞ —Ü–µ–ª–µ–≤—É—é –Ω–æ–¥—É",
                  "REJECTED - –æ—Ç–±—Ä–æ—à–µ–Ω (–∏–∑ mempool –∏–ª–∏ –ø—Ä–∏ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏)",
                  "TIMEOUT_MEMPOOL - —Ç–∞–π–º–∞—É—Ç –≤ mempool",
                  "TIMEOUT_VERIFICATION - —Ç–∞–π–º–∞—É—Ç –ø–æ—Å–ª–µ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏",
                  "TIMEOUT_BLOCKS - —Ç–∞–π–º–∞—É—Ç –ø–æ—Å–ª–µ –ø–æ–ø–∞–¥–∞–Ω–∏—è –≤ –±–ª–æ–∫–∏",
                  "TIMEOUT_TOTAL - –æ–±—â–∏–π —Ç–∞–π–º–∞—É—Ç"
                ],
                "file": "tests/stage-env/src/scenarios/schema.py"
              }
            }
          ]
        },
        {
          "id": "7.2",
          "name": "–ú–æ–¥—É–ª—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –¥–∞—Ç—É–º–æ–≤",
          "status": "pending",
          "tasks": [
            {
              "id": "7.2.1",
              "description": "–°–æ–∑–¥–∞—Ç—å DatumMonitor –∫–ª–∞—Å—Å",
              "status": "pending",
              "file": "tests/stage-env/src/scenarios/datum_monitor.py (NEW)",
              "details": {
              "methods": [
                  "__init__(node_cli_path, log_file) - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è",
                  "async monitor_datum(...) - –≥–ª–∞–≤–Ω—ã–π –º–µ—Ç–æ–¥ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞",
                  "async _check_mempool(node, datum_hash) -> bool - –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤ mempool",
                  "async _check_verified(master_nodes, datum_hash) -> bool - –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏",
                  "async _check_in_blocks(master_nodes, datum_hash) -> Tuple[bool, int] - –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤ –±–ª–æ–∫–∞—Ö + –Ω–æ–º–µ—Ä –±–ª–æ–∫–∞",
                  "async _check_propagated(node, block_num) -> bool - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –±–ª–æ–∫–∞",
                  "async _wait_for_state_change(...) - –æ–∂–∏–¥–∞–Ω–∏–µ —Å–º–µ–Ω—ã —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å —Ç–∞–π–º–∞—É—Ç–æ–º",
                  "_log(...) - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ scenario log"
                ]
              }
            },
            {
              "id": "7.2.2",
              "description": "–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å _check_mempool —á–µ—Ä–µ–∑ mempool proc",
              "status": "pending",
              "implementation": "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å CLI: mempool proc -net <network> -chain <chain> | grep <datum_hash>",
              "fallback": "RPC: mempool.list() + –ø–∞—Ä—Å–∏–Ω–≥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞"
            },
            {
              "id": "7.2.3",
              "description": "–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å _check_verified —á–µ—Ä–µ–∑ logs/GDB",
              "status": "pending",
              "implementation": "–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ master –Ω–æ–¥–∞—Ö: tx_history / ledger | grep <datum_hash>",
              "note": "–ï—Å–ª–∏ –¥–∞—Ç—É–º –∏—Å—á–µ–∑ –∏–∑ mempool –∏ –Ω–µ –æ—Ç–±—Ä–æ—à–µ–Ω —è–≤–Ω–æ - –∑–Ω–∞—á–∏—Ç –ø—Ä–æ—à–µ–ª –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—é"
            },
            {
              "id": "7.2.4",
              "description": "–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å _check_in_blocks",
              "status": "pending",
              "implementation": "CLI: chain list -net <network> -chain <chain> + chain ca -net <network> -chain <chain> -datum <hash>",
              "returns": "Tuple[bool, Optional[int]] - –Ω–∞–π–¥–µ–Ω + –Ω–æ–º–µ—Ä –±–ª–æ–∫–∞"
            },
            {
              "id": "7.2.5",
              "description": "–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å _check_propagated",
              "status": "pending",
              "implementation": "–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Ü–µ–ª–µ–≤–æ–π –Ω–æ–¥–µ: chain info + —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –Ω–æ–º–µ—Ä–∞ –±–ª–æ–∫–∞",
              "details": "–ï—Å–ª–∏ –±–ª–æ–∫ —Å –¥–∞—Ç—É–º–æ–º –¥–æ—à—ë–ª –¥–æ –Ω–æ–¥—ã - –¥–∞—Ç—É–º —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–∏–ª—Å—è"
            }
          ]
        },
        {
          "id": "7.3",
          "name": "–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ executor",
          "status": "pending",
          "tasks": [
            {
              "id": "7.3.1",
              "description": "–î–æ–±–∞–≤–∏—Ç—å _execute_wait_for_datum_step –≤ ScenarioExecutor",
              "status": "pending",
              "file": "tests/stage-env/src/scenarios/executor.py",
              "implementation": [
                "–°–æ–∑–¥–∞—Ç—å —ç–∫–∑–µ–º–ø–ª—è—Ä DatumMonitor",
                "–í—ã–∑–≤–∞—Ç—å monitor_datum —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –∏–∑ step",
                "–û–±—Ä–∞–±–æ—Ç–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç (—Å—Ç–∞—Ç—É—Å + –¥–µ—Ç–∞–ª–∏)",
                "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å—Ç–∞—Ç—É—Å –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω–æ save_status",
                "–ó–∞–ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç",
                "–í–µ—Ä–Ω—É—Ç—å —É—Å–ø–µ—Ö/–Ω–µ—É–¥–∞—á—É"
              ]
            },
            {
              "id": "7.3.2",
              "description": "–î–æ–±–∞–≤–∏—Ç—å dispatch –≤ _execute_steps",
              "status": "pending",
              "file": "tests/stage-env/src/scenarios/executor.py::~450",
              "change": "elif isinstance(step, WaitForDatumStep): await self._execute_wait_for_datum_step(step)"
            },
            {
              "id": "7.3.3",
              "description": "–î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É defaults –¥–ª—è WaitForDatumStep",
              "status": "pending",
              "file": "tests/stage-env/src/scenarios/executor.py::_apply_defaults",
              "fields_to_apply": ["node", "timeout_total", "timeout_mempool", "timeout_verification", "timeout_in_blocks"]
            }
          ]
        },
        {
          "id": "7.4",
          "name": "–û–±—Ä–∞–±–æ—Ç–∫–∞ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –æ—à–∏–±–æ–∫",
          "status": "pending",
          "tasks": [
            {
              "id": "7.4.1",
              "description": "–î–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–±—Ä–æ—à–µ–Ω–Ω–æ–≥–æ –¥–∞—Ç—É–º–∞",
              "status": "pending",
              "logic": "–ï—Å–ª–∏ –¥–∞—Ç—É–º –±—ã–ª –≤ mempool, –ø–æ—Ç–æ–º –∏—Å—á–µ–∑, –Ω–æ –Ω–µ –ø–æ—è–≤–∏–ª—Å—è –≤ –±–ª–æ–∫–∞—Ö –∏ –Ω–µ –≤ tx_history - –∑–Ω–∞—á–∏—Ç –æ—Ç–±—Ä–æ—à–µ–Ω",
              "error_message": "Datum was rejected: disappeared from mempool without verification"
            },
            {
              "id": "7.4.2",
              "description": "–î–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ 'verified but not in blocks'",
              "status": "pending",
              "logic": "–î–∞—Ç—É–º –∏—Å—á–µ–∑ –∏–∑ mempool, –Ω–æ –Ω–µ –ø–æ—è–≤–∏–ª—Å—è –≤ –±–ª–æ–∫–∞—Ö –∑–∞ timeout_verification",
              "error_message": "Datum verified by master nodes but not included in blocks within {timeout}s"
            },
            {
              "id": "7.4.3",
              "description": "–î–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ 'in blocks but not propagated'",
              "status": "pending",
              "logic": "–î–∞—Ç—É–º –≤ –±–ª–æ–∫–∞—Ö –Ω–∞ master –Ω–æ–¥–∞—Ö, –Ω–æ –±–ª–æ–∫ –Ω–µ –¥–æ—à—ë–ª –¥–æ —Ü–µ–ª–µ–≤–æ–π –Ω–æ–¥—ã –∑–∞ timeout_in_blocks",
              "error_message": "Datum in block #{block_num} on master nodes, but block didn't propagate to {node} within {timeout}s"
            },
            {
              "id": "7.4.4",
              "description": "–¢–∞–π–º–∞—É—Ç—ã —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º",
              "status": "pending",
              "implementation": "–ö–∞–∂–¥—ã–π —Ç–∞–π–º–∞—É—Ç –¥–æ–ª–∂–µ–Ω —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ –∫–∞–∫–æ–º —ç—Ç–∞–ø–µ –∑–∞—Å—Ç—Ä—è–ª–∏ + —Å–∫–æ–ª—å–∫–æ –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ",
              "example": "Timeout after 120s: datum stuck in mempool (expected verification within 60s)"
            }
          ]
        },
        {
          "id": "7.5",
          "name": "–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è",
          "status": "pending",
          "tasks": [
            {
              "id": "7.5.1",
              "description": "–°–æ–∑–¥–∞—Ç—å –ø—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è",
              "status": "pending",
              "file": "tests/stage-env/tests/examples/test_wait_for_datum.yml (NEW)",
              "content": "–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è: wait_for_datum —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Ç–∞–π–º–∞—É—Ç–∞–º–∏ –∏ —Å—Ü–µ–Ω–∞—Ä–∏—è–º–∏"
            },
            {
              "id": "7.5.2",
              "description": "–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–µ—Å—Ç—ã",
              "status": "pending",
              "candidates": [
                "tests/e2e/token/002_token_emit.yml - –ø–æ—Å–ª–µ —ç–º–∏—Å—Å–∏–∏",
                "tests/e2e/integration/001_full_token_lifecycle.yml - –ø–æ—Å–ª–µ tx_create",
                "tests/functional/utxo_blocking/*.yml - –ø–æ—Å–ª–µ –≤—Å–µ—Ö tx_create"
              ]
            },
            {
              "id": "7.5.3",
              "description": "–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ Glossary.md",
              "status": "pending",
              "file": "tests/stage-env/docs/ru/scenarios/Glossary.md",
              "section": "Wait-for-Datum Helper - –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è –¥–∞—Ç—É–º–æ–≤"
            },
            {
              "id": "7.5.4",
              "description": "–î–æ–±–∞–≤–∏—Ç—å –≤ Cookbook –ø—Ä–∏–º–µ—Ä—ã",
              "status": "pending",
              "file": "tests/stage-env/docs/ru/scenarios/Cookbook.md",
              "examples": [
                "–û–∂–∏–¥–∞–Ω–∏–µ —ç–º–∏—Å—Å–∏–∏",
                "–û–∂–∏–¥–∞–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏",
                "–û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–∞–π–º–∞—É—Ç–æ–≤",
                "–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ master –Ω–æ–¥–∞—Ö"
              ]
            }
          ]
        }
      ],
      "acceptance_criteria": [
        "‚úÖ WaitForDatumStep —É—Å–ø–µ—à–Ω–æ –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è –≤ schema",
        "‚úÖ DatumMonitor –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –≤—Å–µ 5 —Å–æ—Å—Ç–æ—è–Ω–∏–π",
        "‚úÖ –í—Å–µ 6 —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –æ—à–∏–±–æ–∫ –¥–µ—Ç–µ–∫—Ç–∏—Ä—É—é—Ç—Å—è –∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è",
        "‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å executor —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –æ—à–∏–±–æ–∫",
        "‚úÖ –ü—Ä–∏–º–µ—Ä test_wait_for_datum.yml –ø—Ä–æ—Ö–æ–¥–∏—Ç –≤—Å–µ –∫–µ–π—Å—ã",
        "‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ–ª–Ω–∞—è –∏ –ø–æ–Ω—è—Ç–Ω–∞—è"
      ],
      "estimated_impact": {
        "reliability": "+50% - —è–≤–Ω–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ –≤–º–µ—Å—Ç–æ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–¥–µ—Ä–∂–µ–∫",
        "debug_time": "-70% - —Ç–æ—á–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è –¥–∞—Ç—É–º–æ–≤",
        "test_stability": "+40% - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è –∫ —Å–∫–æ—Ä–æ—Å—Ç–∏ —Å–µ—Ç–∏"
      }
    }
  ],
  
  "completed_work": [
    "‚úÖ –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω—ã –ø—É—Ç–∏ –≤ –∫–æ–Ω—Ñ–∏–≥–µ - –≤—Å–µ –æ—Ç BASE_PATH",
    "‚úÖ –õ–æ–≥–∏ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω—ã –≤ run_* –ø–∞–ø–∫–∞—Ö",
    "‚úÖ –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –ª–æ–≥–∏ —Å –ø–æ–ª–Ω—ã–º –≤—ã–≤–æ–¥–æ–º CLI/RPC –∫–æ–º–∞–Ω–¥ –∏ –æ—Ç–≤–µ—Ç–æ–≤ –Ω–æ–¥",
    "‚úÖ –ê–≤—Ç–æ—Å–±–æ—Ä –≤—Å–µ—Ö –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ –≤ –∫–æ–Ω—Ü–µ —Ç–µ—Å—Ç–æ–≤",
    "‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã —Å–µ–∫—Ü–∏–∏ –∫–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏–∏ –≤ stage-env.cfg –∏ .default",
    "‚úÖ –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∫–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏–∏ —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ –∏ best practices",
    "‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ —á—Ç–µ–Ω–∏—è node_addr.txt (retry –ª–æ–≥–∏–∫–∞)",
    "‚úÖ –°–¥–µ–ª–∞–Ω description –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–º –≤ CLI/RPC —à–∞–≥–∞—Ö –∏ checks"
  ],
  
  "commits": [
    {
      "hash": "a8a3c2f",
      "message": "fix: unify path resolution to use BASE_PATH consistently",
      "files": ["stage_env.py", "src/network/genesis.py"]
    },
    {
      "hash": "06dd5df",
      "message": "feat: organize scenario logs in run_* directories",
      "files": ["stage_env.py", "src/utils/artifacts.py"]
    },
    {
      "hash": "0bf44a6",
      "message": "feat: add detailed logging to scenario executor",
      "files": ["src/scenarios/executor.py", "stage_env.py"]
    },
    {
      "hash": "18196eb",
      "message": "docs: add docker customization sections to stage-env config",
      "files": ["../stage-env.cfg"]
    },
    {
      "hash": "fe3e1ea",
      "message": "docs: update default config with all new sections",
      "files": ["config/stage-env.cfg.default"]
    },
    {
      "hash": "ec5a43d",
      "message": "fix: add retry logic for node_addr.txt and make description optional",
      "files": ["src/network/genesis.py", "src/scenarios/schema.py"]
    }
  ],
  
  "summary": {
    "total_phases": 7,
    "completed_phases": 6,
    "in_progress_phases": 1,
    "completion_rate": "86%",
    "total_commits": 6,
    "files_modified": 9,
    "lines_added": "~500+",
    "impact": "High - improved logging, organization, extensibility, robustness, and test reliability"
  },
  
  "achievements": [
    "üéØ –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω—ã –ø—É—Ç–∏ –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è",
    "üìÅ –û—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ –ø–æ –∑–∞–ø—É—Å–∫–∞–º",
    "üìù –î–µ—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ —Ç–µ—Å—Ç–æ–≤",
    "‚öôÔ∏è –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∫–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏–∏",
    "üîÑ –£—Å—Ç—Ä–∞–Ω–µ–Ω—ã race conditions –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –Ω–æ–¥",
    "‚ú® –£–ø—Ä–æ—â—ë–Ω —Å–∏–Ω—Ç–∞–∫—Å–∏—Å YAML —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤",
    "üöÄ –í –ø—Ä–æ—Ü–µ—Å—Å–µ: Wait-for-Datum Helper –¥–ª—è –Ω–∞–¥—ë–∂–Ω–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –¥–∞—Ç—É–º–æ–≤"
  ],
  
  "current_phase": {
    "id": "phase_cli_execution_fixes",
    "name": "–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è CLI –∫–æ–º–∞–Ω–¥ –∏ –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –æ—à–∏–±–æ–∫",
    "status": "in_progress",
    "started": "2025-10-24T15:28:00Z",
    
    "subphases": [
      {
        "id": "subphase_1_yaml_error_detection",
        "name": "–î–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ YAML –æ—à–∏–±–æ–∫ –æ—Ç CLI",
        "status": "completed",
        "description": "CLI –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫–∏ –≤ YAML —Ñ–æ—Ä–º–∞—Ç–µ —Å exit code 0",
        "solution": "_check_expectation –ø–∞—Ä—Å–∏—Ç YAML/JSON –∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–ª–µ errors",
        "files": ["tests/stage-env/src/scenarios/executor.py::1134-1200"]
      },
      {
        "id": "subphase_2_hash_extraction",
        "name": "–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —ç–∫—Å—Ç—Ä–∞–∫—Ü–∏—è hash –∏–∑ CLI –≤—ã–≤–æ–¥–∞",
        "status": "in_progress",
        "priority": "critical",
        "description": "token_decl, token_emit –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç hash –≤ YAML, –Ω—É–∂–Ω–æ –µ–≥–æ –∏–∑–≤–ª–µ–∫–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏",
        "current_problem": "–°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤–µ—Å—å YAML –≤–º–µ—Å—Ç–æ hash ‚Üí datum monitor –≤–∏—Å–∏—Ç –Ω–∞ –Ω–µ–≤–∞–ª–∏–¥–Ω–æ–º hash",
        "solution_approach": "–ü–∞—Ä—Å–∏—Ç—å YAML –æ—Ç–≤–µ—Ç –∏ –∏–∑–≤–ª–µ–∫–∞—Ç—å –ø–æ–ª–µ hash/tx_hash/datum_hash",
        "files": ["tests/stage-env/src/scenarios/executor.py::414-510"]
      },
      {
        "id": "subphase_3_datum_monitoring",
        "name": "Wait-for-Datum –∑–∞–≤–∏—Å–∞–µ—Ç –Ω–∞ –Ω–µ–≤–∞–ª–∏–¥–Ω—ã—Ö hash",
        "status": "blocked",
        "priority": "critical",
        "blocker": "subphase_2_hash_extraction",
        "description": "DatumMonitor –ø—ã—Ç–∞–µ—Ç—Å—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å YAML —Å –æ—à–∏–±–∫–∞–º–∏ –≤–º–µ—Å—Ç–æ hash",
        "solution": "–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è subphase_2 –ø—Ä–æ–±–ª–µ–º–∞ –¥–æ–ª–∂–Ω–∞ —É–π—Ç–∏",
        "validation": "–î–æ–±–∞–≤–ª–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∞ hash –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –≤ –º–æ–Ω–∏—Ç–æ—Ä–µ",
        "files": ["tests/stage-env/src/monitoring/datum.py::224-236"]
      },
      {
        "id": "subphase_4_network_stability",
        "name": "–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å —Å–µ—Ç–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ",
        "status": "in_progress",
        "priority": "high",
        "problems": [
          "2 –Ω–æ–¥—ã (node6, node7) –Ω–µ –ø–æ–¥–Ω–∏–º–∞—é—Ç—Å—è (unknown state)",
          "Container status = unknown –≤–º–µ—Å—Ç–æ running",
          "–í–æ–∑–º–æ–∂–Ω–æ –ø—Ä–æ–±–ª–µ–º–∞ —Å health checks"
        ],
        "investigation_needed": true,
        "files": [
          "tests/stage-env/src/network/manager.py::319-336 (build nodes array)",
          "tests/stage-env/src/cli/network_commands.py::341-370 (status table)"
        ]
      },
      {
        "id": "subphase_5_data_cleanup",
        "name": "–û—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É —Å—å—é—Ç–∞–º–∏",
        "status": "completed",
        "description": "–ß–∏—Å—Ç–∏—Ç—å user data (wallets, chains, logs) –Ω–æ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã",
        "solution": "clean_test_data() —á–µ—Ä–µ–∑ docker exec –ø–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º —Å—å—é—Ç–æ–º",
        "critical_point": "–ù–ï —É–¥–∞–ª—è—Ç—å lib/ca/ - —Ç–∞–º validator —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –¥–ª—è ROOT —Ä–æ–ª–∏",
        "files": ["tests/stage-env/src/network/manager.py::222-263"]
      }
    ],
    
    "critical_insights": [
      "CLI –≤—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç exit code 0, –æ—à–∏–±–∫–∏ –≤ YAML/JSON",
      "Validator —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –≤ /var/lib/ca/ –ö–†–ò–¢–ò–ß–ù–´ –¥–ª—è ROOT —Ä–æ–ª–∏",
      "docker-compose down -v —É–¥–∞–ª—è–µ—Ç —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã ‚Üí 'You have no access rights'",
      "–ù—É–∂–Ω–∞ —Ö–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞: —Ç–æ–ª—å–∫–æ user data, –Ω–µ system files"
    ],
    
    "next_steps": [
      "1. [CRITICAL] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—á–µ–º—É hash –Ω–µ –∏–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è –∏–∑ YAML (subphase_2)",
      "2. [CRITICAL] –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å –∑–∞–≤–∏—Å–∞–Ω–∏–µ –Ω–∞ wait_for_datum",
      "3. [HIGH] –ü–æ–Ω—è—Ç—å –ø–æ—á–µ–º—É node6/node7 –Ω–µ –ø–æ–¥–Ω–∏–º–∞—é—Ç—Å—è",
      "4. [MEDIUM] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ -net –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ CLI defaults –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ"
    ]
  }
}
