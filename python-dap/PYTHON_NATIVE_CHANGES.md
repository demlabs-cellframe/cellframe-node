# Python Native Integration Changes

## üéØ –¶–µ–ª—å –∏–∑–º–µ–Ω–µ–Ω–∏–π

–£–±—Ä–∞—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ Python —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –≤ DAP SDK –∏ –æ—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å –Ω–∞—Ç–∏–≤–Ω—ã–º–∏ DAP —Ç–∏–ø–∞–º–∏ —Ç–∞–º, –≥–¥–µ —ç—Ç–æ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ.

## üìã –ß—Ç–æ —É–±—Ä–∞–Ω–æ

### 1. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç—å—é
- ‚ùå `DapMemory` –∫–ª–∞—Å—Å (malloc/free/realloc)
- ‚ùå –†—É—á–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç—å—é Python'–æ–º
- ‚ùå Tracking –ø–∞–º—è—Ç–∏ 
- ‚úÖ **–ü—Ä–∏—á–∏–Ω–∞**: Python –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–ø—Ä–∞–≤–ª—è–µ—Ç –ø–∞–º—è—Ç—å—é

### 2. –û–ø–µ—Ä–∞—Ü–∏–∏ —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º
- ‚ùå `DapTime` —Å –ø–æ–ª–Ω—ã–º –Ω–∞–±–æ—Ä–æ–º —Ñ—É–Ω–∫—Ü–∏–π
- ‚ùå –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ Python time –æ–ø–µ—Ä–∞—Ü–∏–π
- ‚úÖ **–û—Å—Ç–∞–≤–ª–µ–Ω–æ**: –¢–æ–ª—å–∫–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å `dap_time_t` —Ç–∏–ø–∞–º–∏

### 3. –°–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã
- ‚ùå `DapSystem` –æ–±—â–µ–≥–æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è
- ‚ùå –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ subprocess
- ‚úÖ **–û—Å—Ç–∞–≤–ª–µ–Ω–æ**: –¢–æ–ª—å–∫–æ DAP-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

## üì¶ –ß—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ

### 1. –£—Ç–∏–ª–∏—Ç—ã —Ç–∏–ø–æ–≤
- ‚úÖ `DapType` - –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è Python ‚Üî DAP —Ç–∏–ø–æ–≤
- ‚úÖ `format_bytes()` - —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–æ–≤
- ‚úÖ –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —É—Ç–∏–ª–∏—Ç–∞—Ä–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

### 2. –£—Ç–∏–ª–∏—Ç—ã –≤—Ä–µ–º–µ–Ω–∏
- ‚úÖ `DapTime` - —Ä–∞–±–æ—Ç–∞ —Å `dap_time_t`
- ‚úÖ `now_dap()` - –ø–æ–ª—É—á–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –≤ DAP —Ñ–æ—Ä–º–∞—Ç–µ
- ‚úÖ `to_rfc822()` - –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –¥–ª—è DAP –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤

### 3. –£—Ç–∏–ª–∏—Ç—ã —Å–∏—Å—Ç–µ–º—ã
- ‚úÖ `DapSystem` - —Ç–æ–ª—å–∫–æ DAP —Å–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã
- ‚úÖ `execute_dap_command()` - –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ DAP –∫–æ–º–∞–Ω–¥
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–º–∞–Ω–¥ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

## üîÑ –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ

### –§–∞–π–ª—ã –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω—ã:
- `memory.py` ‚Üí `types.py` (—Ç–µ–ø–µ—Ä—å —É—Ç–∏–ª–∏—Ç—ã —Ç–∏–ø–æ–≤, –Ω–µ –ø–∞–º—è—Ç—å)
- `core.py` ‚Üí `dap.py` (—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ—Å–Ω–æ–≤–Ω–æ–º—É –∫–ª–∞—Å—Å—É Dap)

### –ö–ª–∞—Å—Å—ã –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω—ã:
- `DapMemory` ‚Üí `DapType`
- `DapTime` ‚Üí `DapTime` (—É–ø—Ä–æ—â–µ–Ω)
- `DapSystem` ‚Üí `DapSystem` (—É–ø—Ä–æ—â–µ–Ω)

### Exceptions –æ–±–Ω–æ–≤–ª–µ–Ω—ã:
- `DapMemoryError` ‚Üí `DapTypeError`

## üß¨ –ù–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```python
# –°—Ç–∞—Ä–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ - –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ Python
with Dap() as dap:
    ptr = dap.memory.malloc(1024)    # ‚ùå –†—É—á–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç—å—é
    dap.memory.free(ptr)             # ‚ùå –†—É—á–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞
    time = dap.time.now()            # ‚ùå –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ time.time()
    result = dap.system.execute("ls") # ‚ùå –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ subprocess

# –ù–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ - —Ç–æ–ª—å–∫–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
with Dap() as dap:
    # Python —Å–∞–º —É–ø—Ä–∞–≤–ª—è–µ—Ç –ø–∞–º—è—Ç—å—é, –Ω–∞–º –Ω–µ –Ω—É–∂–Ω–æ
    formatted = dap.type.format_bytes(1024)  # ‚úÖ –£—Ç–∏–ª–∏—Ç—ã
    dap_time = dap.time.now_dap()           # ‚úÖ DAP –≤—Ä–µ–º—è
    rfc822 = dap.time.to_rfc822(dap_time)   # ‚úÖ DAP —Ñ–æ—Ä–º–∞—Ç
    # –î–ª—è –æ–±—ã—á–Ω—ã—Ö –∫–æ–º–∞–Ω–¥ –∏—Å–ø–æ–ª—å–∑—É–µ–º subprocess.run()
    # –î–ª—è DAP –∫–æ–º–∞–Ω–¥ –∏—Å–ø–æ–ª—å–∑—É–µ–º dap.system.execute_dap_command()
```

## üéØ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

1. **–ú–µ–Ω—å—à–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è**: Python –¥–µ–ª–∞–µ—Ç —Ç–æ, —á—Ç–æ —É–º–µ–µ—Ç –ª—É—á—à–µ –≤—Å–µ–≥–æ
2. **–ü—Ä–æ—â–µ –ø–æ–¥–¥–µ—Ä–∂–∫–∞**: –ú–µ–Ω—å—à–µ –∫–æ–¥–∞ –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏
3. **–õ—É—á—à–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –ò—Å–ø–æ–ª—å–∑—É–µ–º –Ω–∞—Ç–∏–≤–Ω—ã–µ Python –æ–ø–µ—Ä–∞—Ü–∏–∏
4. **–ú–µ–Ω—å—à–µ –æ—à–∏–±–æ–∫**: –ú–µ–Ω—å—à–µ —Ä—É—á–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–µ—Å—É—Ä—Å–∞–º–∏
5. **–ß–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ**: DAP SDK —Ç–æ–ª—å–∫–æ –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å C —Ñ—É–Ω–∫—Ü–∏—è–º–∏

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```python
import dap
from dap import format_bytes, now_dap, to_rfc822

# –ü—Ä–æ—Å—Ç–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
with dap.Dap() as dap:
    # –í—Ä–µ–º—è
    timestamp = now_dap()
    rfc_time = to_rfc822(timestamp)
    
    # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
    size = format_bytes(1024*1024)
    
    # –°–∏—Å—Ç–µ–º–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã
    result = dap.system.execute_dap_command("dap_status")
```

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç

- **–ú–µ–Ω—å—à–µ –∫–æ–¥–∞**: ~50% reduction –≤ core –º–æ–¥—É–ª—è—Ö
- **–ü—Ä–æ—â–µ API**: –¢–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- **–õ—É—á—à–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**: –ù–∞—Ç–∏–≤–Ω—ã–π Python + DAP C —Ñ—É–Ω–∫—Ü–∏–∏
- **–ù–∞–¥—ë–∂–Ω–µ–µ**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–∞–º–∏ 