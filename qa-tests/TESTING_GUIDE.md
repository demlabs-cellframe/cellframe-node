# Cellframe Node QA Testing Guide

## ๐๏ธ ะััะธัะตะบัััะฐ ัะตััะธัะพะฒะฐะฝะธั

ะัะพัะตััะธะพะฝะฐะปัะฝะฐั ัะธััะตะผะฐ ัะตััะธัะพะฒะฐะฝะธั Cellframe Node, ะฟะพัััะพะตะฝะฝะฐั ะฟะพ ะปัััะธะผ ะฟัะฐะบัะธะบะฐะผ ะธ ััะฐะฝะดะฐััะฐะผ ะธะฝะดััััะธะธ.

### ๐ ะกัััะบัััะฐ ะฟัะพะตะบัะฐ

```
qa-tests/
โโโ framework/                  # ะขะตััะพะฒัะน ััะตะนะผะฒะพัะบ
โ   โโโ config/                # ะะพะฝัะธะณััะฐัะธั
โ   โ   โโโ test_config.py     # ะฆะตะฝััะฐะปะธะทะพะฒะฐะฝะฝะฐั ะบะพะฝัะธะณััะฐัะธั
โ   โ   โโโ __init__.py
โ   โโโ utils/                 # ะฃัะธะปะธัั
โ   โ   โโโ command_executor.py # ะัะฟะพะปะฝะตะฝะธะต ะบะพะผะฐะฝะด ั retry
โ   โ   โโโ __init__.py
โ   โโโ pages/                 # Page Objects
โ   โ   โโโ node_cli.py        # CLI ะธะฝัะตััะตะนั ะฝะพะดั
โ   โ   โโโ __init__.py
โ   โโโ assertions/            # ะะฐััะพะผะฝัะต assertions
โ   โ   โโโ node_assertions.py # ะกะฟะตัะธัะธัะฝัะต ะดะปั ะฝะพะดั ะฟัะพะฒะตัะบะธ
โ   โ   โโโ __init__.py
โ   โโโ fixtures/              # Pytest fixtures
โ   โ   โโโ node_fixtures.py   # ะคะธะบััััั ะดะปั ะฝะพะดั
โ   โ   โโโ __init__.py
โ   โโโ __init__.py
โโโ tests/                     # ะขะตััั ะฟะพ ะบะฐัะตะณะพัะธัะผ
โ   โโโ smoke/                 # Smoke ัะตััั
โ   โ   โโโ test_node_basic.py # ะะฐะทะพะฒะฐั ััะฝะบัะธะพะฝะฐะปัะฝะพััั
โ   โ   โโโ __init__.py
โ   โโโ integration/           # ะะฝัะตะณัะฐัะธะพะฝะฝัะต ัะตััั
โ   โ   โโโ test_network_operations.py # ะกะตัะตะฒัะต ะพะฟะตัะฐัะธะธ
โ   โ   โโโ __init__.py
โ   โโโ e2e/                   # End-to-end ัะตััั
โ   โ   โโโ test_node_lifecycle.py # ะะธะทะฝะตะฝะฝัะน ัะธะบะป ะฝะพะดั
โ   โ   โโโ __init__.py
โ   โโโ __init__.py
โโโ data/                      # ะขะตััะพะฒัะต ะดะฐะฝะฝัะต
โ   โโโ test_data/             # ะะฐะฝะฝัะต ะดะปั ัะตััะพะฒ
โ   โ   โโโ network_test_data.py # ะกะตัะตะฒัะต ะดะฐะฝะฝัะต
โ   โ   โโโ __init__.py
โ   โโโ expected_results/      # ะะถะธะดะฐะตะผัะต ัะตะทัะปััะฐัั
โโโ reports/                   # ะััะตัั
โโโ conftest.py               # ะะปะพะฑะฐะปัะฝะฐั ะบะพะฝัะธะณััะฐัะธั pytest
โโโ pytest.ini               # ะะพะฝัะธะณััะฐัะธั pytest
โโโ requirements.txt          # ะะฐะฒะธัะธะผะพััะธ
```

## ๐ฏ ะัะธะฝัะธะฟั ะฐััะธัะตะบัััั

### 1. **ะะพะดัะปัะฝะพััั**
- ะะฐะถะดัะน ะบะพะผะฟะพะฝะตะฝั ะธะผะตะตั ัะตัะบัั ะพัะฒะตัััะฒะตะฝะฝะพััั
- ะะตะณะบะพะต ะฟะตัะตะธัะฟะพะปัะทะพะฒะฐะฝะธะต ะบะพะดะฐ
- ะัะพััะพะต ะดะพะฑะฐะฒะปะตะฝะธะต ะฝะพะฒัั ัะตััะพะฒ

### 2. **ะะพะฝัะธะณััะธััะตะผะพััั**
- ะฆะตะฝััะฐะปะธะทะพะฒะฐะฝะฝะฐั ะบะพะฝัะธะณััะฐัะธั ัะตัะตะท `test_config.py`
- ะะพะดะดะตัะถะบะฐ ัะฐะทะปะธัะฝัั ะพะบััะถะตะฝะธะน
- ะะตัะตะผะตะฝะฝัะต ะพะบััะถะตะฝะธั ะดะปั ะฝะฐัััะพะนะบะธ

### 3. **Page Object Pattern**
- CLI ะธะฝัะตััะตะนั ะธะฝะบะฐะฟััะปะธัะพะฒะฐะฝ ะฒ `NodeCLI` ะบะปะฐัั
- ะััะพะบะพััะพะฒะฝะตะฒัะต ะผะตัะพะดั ะดะปั ะฒะทะฐะธะผะพะดะตะนััะฒะธั ั ะฝะพะดะพะน
- ะกะบัััะธะต ะดะตัะฐะปะตะน ัะตะฐะปะธะทะฐัะธะธ

### 4. **ะะฐะดะตะถะฝะพััั**
- Retry ะปะพะณะธะบะฐ ะดะปั ะฝะตััะฐะฑะธะปัะฝัั ะพะฟะตัะฐัะธะน
- Proper error handling
- ะขะฐะนะผะฐััั ะธ ะปะธะผะธัั

### 5. **ะะฐะฑะปัะดะฐะตะผะพััั**
- ะะพะดัะพะฑะฝะพะต ะปะพะณะธัะพะฒะฐะฝะธะต
- Allure ะพััะตัั ั attachments
- ะะตััะธะบะธ ะฟัะพะธะทะฒะพะดะธัะตะปัะฝะพััะธ

## ๐ ะัััััะน ััะฐัั

### ะฃััะฐะฝะพะฒะบะฐ ะทะฐะฒะธัะธะผะพััะตะน

```bash
pip install -r requirements.txt
```

### ะะฐะฟััะบ ัะตััะพะฒ

```bash
# ะัะต ัะตััั
pytest

# ะขะพะปัะบะพ smoke ัะตััั
pytest -m smoke

# ะขะพะปัะบะพ ะธะฝัะตะณัะฐัะธะพะฝะฝัะต ัะตััั
pytest -m integration

# E2E ัะตััั
pytest -m e2e

# ะขะตััั ั ะพััะตัะพะผ Allure
pytest --alluredir=allure-results
allure serve allure-results
```

### ะะพะฝัะธะณััะฐัะธั

ะะฐัััะพะนัะต ะฟะตัะตะผะตะฝะฝัะต ะพะบััะถะตะฝะธั:

```bash
export CELLFRAME_NODE_DIR="/opt/cellframe-node"
export QA_MAX_MEMORY_MB="1024"
export QA_MAX_CPU_PERCENT="50.0"
export QA_ENVIRONMENT="docker"
export QA_DEBUG="true"
```

## ๐ ะะฐัะตะณะพัะธะธ ัะตััะพะฒ

### ๐ฅ Smoke Tests
**ะฆะตะปั**: ะััััะฐั ะฟัะพะฒะตัะบะฐ ะพัะฝะพะฒะฝะพะน ััะฝะบัะธะพะฝะฐะปัะฝะพััะธ
- ะัะตะผั ะฒัะฟะพะปะฝะตะฝะธั: < 2 ะผะธะฝัั
- ะะฐะฟััะบะฐัััั ะฟัะธ ะบะฐะถะดะพะผ ะบะพะผะผะธัะต
- ะัะธัะธัะตัะบะธ ะฒะฐะถะฝัะต ััะฝะบัะธะธ

**ะัะธะผะตัั**:
- ะะพะดะฐ ะทะฐะฟััะตะฝะฐ ะธ ะพัะฒะตัะฐะตั
- ะะตััะธั ะดะพัััะฟะฝะฐ
- ะะฐะทะพะฒัะต CLI ะบะพะผะฐะฝะดั ัะฐะฑะพัะฐัั

### ๐ Integration Tests
**ะฆะตะปั**: ะัะพะฒะตัะบะฐ ะฒะทะฐะธะผะพะดะตะนััะฒะธั ะบะพะผะฟะพะฝะตะฝัะพะฒ
- ะัะตะผั ะฒัะฟะพะปะฝะตะฝะธั: 5-10 ะผะธะฝัั
- ะกะตัะตะฒัะต ะพะฟะตัะฐัะธะธ
- ะะทะฐะธะผะพะดะตะนััะฒะธะต ั ะฒะฝะตัะฝะธะผะธ ัะธััะตะผะฐะผะธ

**ะัะธะผะตัั**:
- ะกัะฐััั ัะตัะตะน
- ะะพะดะบะปััะตะฝะธะต ะบ peers
- ะัะพะธะทะฒะพะดะธัะตะปัะฝะพััั ะบะพะผะฐะฝะด

### ๐ End-to-End Tests
**ะฆะตะปั**: ะะพะปะฝัะต ะฟะพะปัะทะพะฒะฐัะตะปััะบะธะต ััะตะฝะฐัะธะธ
- ะัะตะผั ะฒัะฟะพะปะฝะตะฝะธั: 10-30 ะผะธะฝัั
- ะะตะฐะปัะฝัะต workflow
- ะกััะตัั-ัะตััะธัะพะฒะฐะฝะธะต

**ะัะธะผะตัั**:
- ะะพะปะฝัะน ะถะธะทะฝะตะฝะฝัะน ัะธะบะป ะฝะพะดั
- ะะปะธัะตะปัะฝะฐั ััะฐะฑะธะปัะฝะพััั
- ะะตััััะพะตะผะบะธะต ะพะฟะตัะฐัะธะธ

## ๐๏ธ ะะพะฑะฐะฒะปะตะฝะธะต ะฝะพะฒัั ัะตััะพะฒ

### 1. Smoke ัะตัั

```python
import pytest
import allure
from framework import NodeCLI, NodeAssertions

@allure.epic("Cellframe Node")
@allure.feature("New Feature")
@pytest.mark.smoke
@pytest.mark.critical
class TestNewFeature:
    
    @allure.title("New feature works correctly")
    def test_new_feature(self, node_cli: NodeCLI, node_assertions: NodeAssertions):
        # Arrange
        
        # Act
        result = node_cli.execute_custom_command("new_command")
        
        # Assert
        node_assertions.assert_command_success(result)
        node_assertions.assert_output_contains(result, "expected_text")
```

### 2. ะะฝัะตะณัะฐัะธะพะฝะฝัะน ัะตัั

```python
@pytest.mark.integration
@pytest.mark.network
class TestNetworkIntegration:
    
    def test_network_integration(self, node_cli: NodeCLI, wait_for_networks):
        # ะะพะปะตะต ัะปะพะถะฝะฐั ะปะพะณะธะบะฐ
        networks_status = node_cli.get_all_networks_status()
        
        for network_name, status in networks_status.items():
            # ะัะพะฒะตัะบะธ ะธะฝัะตะณัะฐัะธะธ
            pass
```

### 3. E2E ัะตัั

```python
@pytest.mark.e2e
@pytest.mark.slow
class TestCompleteWorkflow:
    
    def test_complete_workflow(self, isolated_test_environment):
        # ะะพะปะฝัะน ััะตะฝะฐัะธะน ะธัะฟะพะปัะทะพะฒะฐะฝะธั
        pass
```

## ๐จ ะัััะธะต ะฟัะฐะบัะธะบะธ

### 1. **ะะผะตะฝะพะฒะฐะฝะธะต ัะตััะพะฒ**
- ะัะฟะพะปัะทัะนัะต ะพะฟะธัะฐัะตะปัะฝัะต ะธะผะตะฝะฐ
- ะคะพัะผะฐั: `test_what_when_then`
- ะัะธะผะตั: `test_network_status_when_online_then_returns_valid_data`

### 2. **ะกัััะบัััะฐ ัะตััะพะฒ**
```python
def test_something(self):
    # Arrange - ะฟะพะดะณะพัะพะฒะบะฐ
    
    # Act - ะดะตะนััะฒะธะต
    
    # Assert - ะฟัะพะฒะตัะบะฐ
```

### 3. **ะัะฟะพะปัะทะพะฒะฐะฝะธะต ะผะฐัะบะตัะพะฒ**
```python
@pytest.mark.smoke      # ะะฐัะตะณะพัะธั
@pytest.mark.critical   # ะะฐะถะฝะพััั
@pytest.mark.network    # ะะฑะปะฐััั
@pytest.mark.slow       # ะฅะฐัะฐะบัะตัะธััะธะบะฐ
```

### 4. **Allure ะฐะฝะฝะพัะฐัะธะธ**
```python
@allure.epic("Cellframe Node")
@allure.feature("Network Operations")
@allure.story("Network Status")
@allure.title("Network returns valid status")
@allure.description("Detailed test description")
```

### 5. **ะคะธะบััััั**
- ะัะฟะพะปัะทัะนัะต ะฟะพะดัะพะดััะธะน scope
- `session` - ะดะปั ะดะพัะพะณะธั ัะตััััะพะฒ
- `function` - ะดะปั ะธะทะพะปััะธะธ ัะตััะพะฒ
- `class` - ะดะปั ะณััะฟะฟั ัะฒัะทะฐะฝะฝัั ัะตััะพะฒ

### 6. **Assertions**
- ะัะฟะพะปัะทัะนัะต ะบะฐััะพะผะฝัะต assertions ะธะท `NodeAssertions`
- ะะพะฑะฐะฒะปัะนัะต ะธะฝัะพัะผะฐัะธะฒะฝัะต ัะพะพะฑัะตะฝะธั ะพะฑ ะพัะธะฑะบะฐั
- ะัะพะฒะตััะนัะต ะฝะต ัะพะปัะบะพ ััะฟะตั, ะฝะพ ะธ ะฟัะพะธะทะฒะพะดะธัะตะปัะฝะพััั

### 7. **ะะฐะฝะฝัะต**
- ะัะฝะพัะธัะต ัะตััะพะฒัะต ะดะฐะฝะฝัะต ะฒ `data/test_data/`
- ะัะฟะพะปัะทัะนัะต ะฟะฐัะฐะผะตััะธะทะฐัะธั ะดะปั data-driven ัะตััะพะฒ
- ะะทะฑะตะณะฐะนัะต ัะฐัะดะบะพะดะฐ ะฒ ัะตััะฐั

## ๐ง ะะพะฝัะธะณััะฐัะธั ะธ ะฝะฐัััะพะนะบะฐ

### ะะตัะตะผะตะฝะฝัะต ะพะบััะถะตะฝะธั

| ะะตัะตะผะตะฝะฝะฐั | ะะฟะธัะฐะฝะธะต | ะะพ ัะผะพะปัะฐะฝะธั |
|------------|----------|--------------|
| `CELLFRAME_NODE_DIR` | ะะธัะตะบัะพัะธั ะฝะพะดั | `/opt/cellframe-node` |
| `QA_MAX_MEMORY_MB` | ะะธะผะธั ะฟะฐะผััะธ | `1024` |
| `QA_MAX_CPU_PERCENT` | ะะธะผะธั CPU | `50.0` |
| `QA_ENVIRONMENT` | ะะบััะถะตะฝะธะต | `docker` |
| `QA_DEBUG` | ะะตะถะธะผ ะพัะปะฐะดะบะธ | `false` |
| `QA_TIMEOUT` | ะขะฐะนะผะฐัั ัะตััะพะฒ | `300` |

### Pytest ะพะฟัะธะธ

```bash
# ะะฐะฟััะบ ั ะดะพะฟะพะปะฝะธัะตะปัะฝัะผะธ ะพะฟัะธัะผะธ
pytest --run-slow                    # ะะบะปััะธัั ะผะตะดะปะตะฝะฝัะต ัะตััั
pytest --node-required               # ะขัะตะฑะพะฒะฐัั ะทะฐะฟััะตะฝะฝัั ะฝะพะดั
pytest --test-category=smoke         # ะขะพะปัะบะพ smoke ัะตััั
pytest -n auto                      # ะะฐัะฐะปะปะตะปัะฝะพะต ะฒัะฟะพะปะฝะตะฝะธะต
pytest --reruns 2                   # ะะพะฒัะพั ัะฟะฐะฒัะธั ัะตััะพะฒ
```

## ๐ ะััะตัะฝะพััั

### Allure Reports
- ะะพะดัะพะฑะฝัะต ะพััะตัั ั ะธััะพัะธะตะน
- ะกะบัะธะฝัะพัั ะธ ะปะพะณะธ
- ะะตััะธะบะธ ะฟัะพะธะทะฒะพะดะธัะตะปัะฝะพััะธ
- ะขัะตะฝะดะพะฒัะน ะฐะฝะฐะปะธะท

### JUnit XML
- ะะฝัะตะณัะฐัะธั ั CI/CD
- ะกัะฐะฝะดะฐััะฝัะน ัะพัะผะฐั
- ะกะพะฒะผะตััะธะผะพััั ั Jenkins, GitLab CI

### Coverage Reports
- ะะพะบัััะธะต ะบะพะดะฐ ััะตะนะผะฒะพัะบะฐ
- HTML ะพััะตัั
- ะะฝัะตะณัะฐัะธั ั SonarQube

## ๐จ Troubleshooting

### ะงะฐัััะต ะฟัะพะฑะปะตะผั

1. **ะะพะดะฐ ะฝะต ะทะฐะฟััะตะฝะฐ**
   ```
   Solution: ะฃะฑะตะดะธัะตัั ััะพ cellframe-node ะทะฐะฟััะตะฝ
   ```

2. **ะขะฐะนะผะฐััั ัะตััะพะฒ**
   ```
   Solution: ะฃะฒะตะปะธัััะต QA_TIMEOUT ะธะปะธ ะพะฟัะธะผะธะทะธััะนัะต ัะตััั
   ```

3. **ะัะพะฑะปะตะผั ั ะฟัััะผะธ**
   ```
   Solution: ะัะพะฒะตัััะต CELLFRAME_NODE_DIR
   ```

4. **ะะตััะฐะฑะธะปัะฝัะต ัะตััั**
   ```
   Solution: ะัะฟะพะปัะทัะนัะต retry ะปะพะณะธะบั ะธ proper waits
   ```

### ะัะปะฐะดะบะฐ

```bash
# ะะพะดัะพะฑะฝัะต ะปะพะณะธ
pytest --log-cli-level=DEBUG

# ะััะฐะฝะพะฒะบะฐ ะฝะฐ ะฟะตัะฒะพะน ะพัะธะฑะบะต
pytest -x

# ะะฐะฟััะบ ะบะพะฝะบัะตัะฝะพะณะพ ัะตััะฐ
pytest tests/smoke/test_node_basic.py::TestNodeBasic::test_node_is_running -v
```

## ๐ CI/CD ะธะฝัะตะณัะฐัะธั

### GitLab CI ะฟัะธะผะตั

```yaml
test:
  stage: test
  script:
    - pip install -r requirements.txt
    - pytest -m smoke --junitxml=reports/junit.xml
  artifacts:
    reports:
      junit: reports/junit.xml
    paths:
      - allure-results/
    expire_in: 1 week
```

## ๐ ะะตััะธะบะธ ะบะฐัะตััะฒะฐ

### ะฆะตะปะธ ะฟะพะบัััะธั
- **Smoke ัะตััั**: 100% ะบัะธัะธัะตัะบะพะน ััะฝะบัะธะพะฝะฐะปัะฝะพััะธ
- **Integration ัะตััั**: 80% API endpoints
- **E2E ัะตััั**: 60% ะฟะพะปัะทะพะฒะฐัะตะปััะบะธั ััะตะฝะฐัะธะตะฒ

### SLA ะฟัะพะธะทะฒะพะดะธัะตะปัะฝะพััะธ
- **Smoke ัะตััั**: < 2 ะผะธะฝัั
- **Integration ัะตััั**: < 10 ะผะธะฝัั  
- **E2E ัะตััั**: < 30 ะผะธะฝัั

### ะกัะฐะฑะธะปัะฝะพััั
- **Success rate**: > 95%
- **Flaky tests**: < 5%
- **False positives**: < 1%

---

## ๐ฏ ะะฐะบะปััะตะฝะธะต

ะญัะฐ ะฐััะธัะตะบัััะฐ ัะตััะธัะพะฒะฐะฝะธั ะพะฑะตัะฟะตัะธะฒะฐะตั:

โ **ะัะพัะตััะธะพะฝะฐะปัะฝะพะต ะบะฐัะตััะฒะพ** - ัะปะตะดะพะฒะฐะฝะธะต ะปัััะธะผ ะฟัะฐะบัะธะบะฐะผ ะธะฝะดััััะธะธ
โ **ะะฐัััะฐะฑะธััะตะผะพััั** - ะปะตะณะบะพะต ะดะพะฑะฐะฒะปะตะฝะธะต ะฝะพะฒัั ัะตััะพะฒ
โ **ะะฐะดะตะถะฝะพััั** - ััะฐะฑะธะปัะฝัะต ะธ ะธะฝัะพัะผะฐัะธะฒะฝัะต ัะตััั
โ **ะญััะตะบัะธะฒะฝะพััั** - ะฑััััะฐั ะพะฑัะฐัะฝะฐั ัะฒัะทั ัะฐะทัะฐะฑะพััะธะบะฐะผ
โ **ะะฐะฑะปัะดะฐะตะผะพััั** - ะฟะพะดัะพะฑะฝะฐั ะพััะตัะฝะพััั ะธ ะผะตััะธะบะธ

**ะกะธััะตะผะฐ ะณะพัะพะฒะฐ ะบ ะฟัะพะดัะบัะธะฒะฝะพะผั ะธัะฟะพะปัะทะพะฒะฐะฝะธั!** ๐
